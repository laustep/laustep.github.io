<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Stereographic truncated tesseract</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
    <link href="../libraries/highlighters/prettify/css/minimal.css" rel="stylesheet"> 
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-3">
        <div style="float:right;clear:both;margin-right:50px;margin-top:150px;">
          <a href="https://www.r-bloggers.com/">
            <img src="https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png" alt="stla" width="100%" />
          </a>
          <br />
          <a href="http://t-redactyl.io/">
            <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:29px;">Standard error</span>
          </a>
          <a href="http://timelyportfolio.blogspot.be/">
            <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:27px;">Timely portfolio</span>
          </a>
          <br />
          <a href="https://antoineguillot.wordpress.com/blog/">
            <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:25px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
          </a>
          <br />
          <a href="https://fronkonstin.com/">
            <span style="color:black;background-color:gold;font-weight:bold;font-size:32px;border:3px solid;border-color:gold;">Fronkonstin</span>
          </a>
        </div>
      </div>

      <div class="main col-sm-9">
        <div id="header">
          <div id="logo" style="position:absolute;">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Stereographic truncated tesseract</h1> 
          <div class="info">
    Posted on December 16, 2019
    
        by St√©phane Laurent
    
</div>
<div class="info">
    
    Tags: <a href="../tags/R.html">R</a>, <a href="../tags/asymptote.html">asymptote</a>, <a href="../tags/povray.html">povray</a>, <a href="../tags/rgl.html">rgl</a>, <a href="../tags/graphics.html">graphics</a>, <a href="../tags/geometry.html">geometry</a>
    
</div>

<ul>
<li><a href="#the-stereographic-truncated-tesseract">The stereographic truncated tesseract</a></li>
<li><a href="#drawing-with-rgl-r">Drawing with rgl (R)</a></li>
<li><a href="#drawing-with-asymptote">Drawing with Asymptote</a></li>
<li><a href="#drawing-with-pov-ray">Drawing with POV-Ray</a></li>
</ul>
<h1 id="the-stereographic-truncated-tesseract">The stereographic truncated tesseract</h1>
<p>We show how to draw a stereographic truncated tesseract with rgl (R), Asymptote, and POV-Ray.</p>
<p>The truncated tesseract is a uniform polychoron. Among its cells, there are sixteen tetrahedra, and we fill the faces of these tetrahedra.</p>
<p>Using Asymptote and POV-Ray, we include a 4D rotation to animate the figure.</p>
<p>We call it <em>stereographic</em> because we map each edge to the 3-sphere before applying the stereographic projection.</p>
<h1 id="drawing-with-rgl-r">Drawing with rgl (R)</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(cxhull)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(abind)</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co"># vertices #####################################################################</span></a>
<a class="sourceLine" id="cb1-6" title="6">sqr2p1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-7" title="7">vertices &lt;-<span class="st"> </span><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-9" title="9">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-11" title="11">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-12" title="12">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-13" title="13">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-14" title="14">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-15" title="15">  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, sqr2p1, sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-16" title="16">  <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-17" title="17">  <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-18" title="18">  <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-19" title="19">  <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-20" title="20">  <span class="kw">c</span>(<span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-21" title="21">  <span class="kw">c</span>(<span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-22" title="22">  <span class="kw">c</span>(<span class="dv">1</span>, sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-23" title="23">  <span class="kw">c</span>(<span class="dv">1</span>, sqr2p1, sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-24" title="24">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-25" title="25">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-26" title="26">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">-1</span>, sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-27" title="27">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">-1</span>, sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-28" title="28">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-29" title="29">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-30" title="30">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-31" title="31">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">1</span>, sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-32" title="32">  <span class="kw">c</span>(sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-33" title="33">  <span class="kw">c</span>(sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-34" title="34">  <span class="kw">c</span>(sqr2p1, <span class="dv">-1</span>, sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-35" title="35">  <span class="kw">c</span>(sqr2p1, <span class="dv">-1</span>, sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-36" title="36">  <span class="kw">c</span>(sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-37" title="37">  <span class="kw">c</span>(sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-38" title="38">  <span class="kw">c</span>(sqr2p1, <span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-39" title="39">  <span class="kw">c</span>(sqr2p1, <span class="dv">1</span>, sqr2p1, sqr2p1),</a>
<a class="sourceLine" id="cb1-40" title="40">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-41" title="41">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>, sqr2p1),</a>
<a class="sourceLine" id="cb1-42" title="42">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-43" title="43">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>, sqr2p1),</a>
<a class="sourceLine" id="cb1-44" title="44">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-45" title="45">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">-1</span>, sqr2p1),</a>
<a class="sourceLine" id="cb1-46" title="46">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-47" title="47">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">1</span>, sqr2p1),</a>
<a class="sourceLine" id="cb1-48" title="48">  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-49" title="49">  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>, sqr2p1),</a>
<a class="sourceLine" id="cb1-50" title="50">  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-51" title="51">  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>, sqr2p1),</a>
<a class="sourceLine" id="cb1-52" title="52">  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-53" title="53">  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="dv">-1</span>, sqr2p1),</a>
<a class="sourceLine" id="cb1-54" title="54">  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1),</a>
<a class="sourceLine" id="cb1-55" title="55">  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="dv">1</span>, sqr2p1),</a>
<a class="sourceLine" id="cb1-56" title="56">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-57" title="57">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-58" title="58">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-59" title="59">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-60" title="60">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-61" title="61">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-62" title="62">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, sqr2p1, <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-63" title="63">  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, sqr2p1, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-64" title="64">  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-65" title="65">  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-66" title="66">  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-67" title="67">  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-68" title="68">  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-69" title="69">  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-70" title="70">  <span class="kw">c</span>(sqr2p1, sqr2p1, sqr2p1, <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb1-71" title="71">  <span class="kw">c</span>(sqr2p1, sqr2p1, sqr2p1, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-72" title="72">)</a>
<a class="sourceLine" id="cb1-73" title="73"></a>
<a class="sourceLine" id="cb1-74" title="74"><span class="co"># convex hull is the polytope itself, since it is convex #######################</span></a>
<a class="sourceLine" id="cb1-75" title="75">hull &lt;-<span class="st"> </span><span class="kw">cxhull</span>(vertices)</a>
<a class="sourceLine" id="cb1-76" title="76"></a>
<a class="sourceLine" id="cb1-77" title="77"><span class="co"># edges ########################################################################</span></a>
<a class="sourceLine" id="cb1-78" title="78">edges &lt;-<span class="st"> </span>hull<span class="op">$</span>edges</a>
<a class="sourceLine" id="cb1-79" title="79"></a>
<a class="sourceLine" id="cb1-80" title="80"><span class="co"># (triangular) faces of the tetrahedra ######################################### </span></a>
<a class="sourceLine" id="cb1-81" title="81">ridgeSizes &lt;-<span class="st"> </span><span class="kw">sapply</span>(hull<span class="op">$</span>ridges, <span class="cf">function</span>(ridge) <span class="kw">length</span>(ridge<span class="op">$</span>vertices))</a>
<a class="sourceLine" id="cb1-82" title="82">triangles &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">sapply</span>(hull<span class="op">$</span>ridges[<span class="kw">which</span>(ridgeSizes<span class="op">==</span><span class="dv">3</span>)], </a>
<a class="sourceLine" id="cb1-83" title="83">                      <span class="cf">function</span>(ridge) ridge<span class="op">$</span>vertices))</a>
<a class="sourceLine" id="cb1-84" title="84"></a>
<a class="sourceLine" id="cb1-85" title="85"><span class="co"># stereographic projection #####################################################</span></a>
<a class="sourceLine" id="cb1-86" title="86">sproj &lt;-<span class="st"> </span><span class="cf">function</span>(p, r){</a>
<a class="sourceLine" id="cb1-87" title="87">  <span class="kw">c</span>(p[<span class="dv">1</span>], p[<span class="dv">2</span>], p[<span class="dv">3</span>])<span class="op">/</span>(r<span class="op">-</span>p[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb1-88" title="88">}</a>
<a class="sourceLine" id="cb1-89" title="89"></a>
<a class="sourceLine" id="cb1-90" title="90"><span class="co"># spherical segment ############################################################</span></a>
<a class="sourceLine" id="cb1-91" title="91">sphericalSegment &lt;-<span class="st"> </span><span class="cf">function</span>(P, Q, r, n){</a>
<a class="sourceLine" id="cb1-92" title="92">  out &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_real_</span>, <span class="dt">nrow =</span> n<span class="op">+</span><span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-93" title="93">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb1-94" title="94">    pt &lt;-<span class="st"> </span>P <span class="op">+</span><span class="st"> </span>(i<span class="op">/</span>n)<span class="op">*</span>(Q<span class="op">-</span>P)</a>
<a class="sourceLine" id="cb1-95" title="95">    out[i<span class="op">+</span>1L, ] &lt;-<span class="st"> </span>r<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(pt))) <span class="op">*</span><span class="st"> </span>pt</a>
<a class="sourceLine" id="cb1-96" title="96">  }</a>
<a class="sourceLine" id="cb1-97" title="97">  out</a>
<a class="sourceLine" id="cb1-98" title="98">}</a>
<a class="sourceLine" id="cb1-99" title="99"></a>
<a class="sourceLine" id="cb1-100" title="100"><span class="co"># stereographic edge ###########################################################</span></a>
<a class="sourceLine" id="cb1-101" title="101">stereoEdge &lt;-<span class="st"> </span><span class="cf">function</span>(verts, edge, r, n){</a>
<a class="sourceLine" id="cb1-102" title="102">  P &lt;-<span class="st"> </span>verts[edge[<span class="dv">1</span>], ]</a>
<a class="sourceLine" id="cb1-103" title="103">  Q &lt;-<span class="st"> </span>verts[edge[<span class="dv">2</span>], ]</a>
<a class="sourceLine" id="cb1-104" title="104">  PQ &lt;-<span class="st"> </span><span class="kw">sphericalSegment</span>(P, Q, r, n)</a>
<a class="sourceLine" id="cb1-105" title="105">  pq &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(PQ, <span class="dv">1</span>, <span class="cf">function</span>(M){<span class="kw">sproj</span>(M, r)}))</a>
<a class="sourceLine" id="cb1-106" title="106">  dists &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">apply</span>(pq, <span class="dv">1</span>, crossprod))</a>
<a class="sourceLine" id="cb1-107" title="107">  <span class="kw">cylinder3d</span>(pq, <span class="dt">radius =</span> <span class="kw">log1p</span>(dists<span class="op">/</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">4</span>, <span class="dt">sides =</span> <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb1-108" title="108">}</a>
<a class="sourceLine" id="cb1-109" title="109"></a>
<a class="sourceLine" id="cb1-110" title="110"><span class="co"># stereographic subdivision (to fill the triangles) ############################</span></a>
<a class="sourceLine" id="cb1-111" title="111">midpoint4 &lt;-<span class="st"> </span><span class="cf">function</span>(A, B, r){</a>
<a class="sourceLine" id="cb1-112" title="112">  M &lt;-<span class="st"> </span>(A <span class="op">+</span><span class="st"> </span>B) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1-113" title="113">  lg &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(M))) <span class="op">/</span><span class="st"> </span>r</a>
<a class="sourceLine" id="cb1-114" title="114">  M <span class="op">/</span><span class="st"> </span>lg</a>
<a class="sourceLine" id="cb1-115" title="115">} </a>
<a class="sourceLine" id="cb1-116" title="116"></a>
<a class="sourceLine" id="cb1-117" title="117">subdiv0 &lt;-<span class="st"> </span><span class="cf">function</span>(A, B, C, r){</a>
<a class="sourceLine" id="cb1-118" title="118">  mAB &lt;-<span class="st"> </span><span class="kw">midpoint4</span>(A, B, r)</a>
<a class="sourceLine" id="cb1-119" title="119">  mAC &lt;-<span class="st"> </span><span class="kw">midpoint4</span>(A, C, r)</a>
<a class="sourceLine" id="cb1-120" title="120">  mBC &lt;-<span class="st"> </span><span class="kw">midpoint4</span>(B, C, r)</a>
<a class="sourceLine" id="cb1-121" title="121">  out &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA_real_</span>, <span class="dt">dim =</span> <span class="kw">c</span>(4L, 3L, 4L))</a>
<a class="sourceLine" id="cb1-122" title="122">  out[<span class="dv">1</span>,,] &lt;-<span class="st"> </span><span class="kw">rbind</span>(A, mAB, mAC)</a>
<a class="sourceLine" id="cb1-123" title="123">  out[<span class="dv">2</span>,,] &lt;-<span class="st"> </span><span class="kw">rbind</span>(B, mBC, mAB)</a>
<a class="sourceLine" id="cb1-124" title="124">  out[<span class="dv">3</span>,,] &lt;-<span class="st"> </span><span class="kw">rbind</span>(C, mAC, mBC)</a>
<a class="sourceLine" id="cb1-125" title="125">  out[<span class="dv">4</span>,,] &lt;-<span class="st"> </span><span class="kw">rbind</span>(mAB, mBC, mAC)</a>
<a class="sourceLine" id="cb1-126" title="126">  out</a>
<a class="sourceLine" id="cb1-127" title="127">}</a>
<a class="sourceLine" id="cb1-128" title="128"></a>
<a class="sourceLine" id="cb1-129" title="129">subdiv &lt;-<span class="st"> </span><span class="cf">function</span>(n, A, B, C, r){</a>
<a class="sourceLine" id="cb1-130" title="130">  <span class="cf">if</span>(n <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb1-131" title="131">    <span class="kw">return</span>(<span class="kw">subdiv0</span>(A, B, C, r))</a>
<a class="sourceLine" id="cb1-132" title="132">  }</a>
<a class="sourceLine" id="cb1-133" title="133">  triangles &lt;-<span class="st"> </span><span class="kw">subdiv</span>(n<span class="dv">-1</span>, A, B, C, r)</a>
<a class="sourceLine" id="cb1-134" title="134">  out &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA_real_</span>, <span class="dt">dim =</span> <span class="kw">c</span>(0L, 3L, 4L))</a>
<a class="sourceLine" id="cb1-135" title="135">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="dv">4</span><span class="op">^</span>(n<span class="dv">-1</span>))){</a>
<a class="sourceLine" id="cb1-136" title="136">    trgl &lt;-<span class="st"> </span>triangles[i,,]</a>
<a class="sourceLine" id="cb1-137" title="137">    out &lt;-<span class="st"> </span><span class="kw">abind</span>(out, <span class="kw">subdiv0</span>(trgl[1L,], trgl[2L,], trgl[3L,], r), <span class="dt">along =</span> 1L)</a>
<a class="sourceLine" id="cb1-138" title="138">  }</a>
<a class="sourceLine" id="cb1-139" title="139">  out</a>
<a class="sourceLine" id="cb1-140" title="140">}</a>
<a class="sourceLine" id="cb1-141" title="141"></a>
<a class="sourceLine" id="cb1-142" title="142"><span class="co"># mesh maker ###################################################################</span></a>
<a class="sourceLine" id="cb1-143" title="143">stereoTriangle &lt;-<span class="st"> </span><span class="cf">function</span>(n, A, B, C, r){</a>
<a class="sourceLine" id="cb1-144" title="144">  triangles &lt;-<span class="st"> </span><span class="kw">subdiv</span>(n, A, B, C, r)</a>
<a class="sourceLine" id="cb1-145" title="145">  ntriangles &lt;-<span class="st"> </span><span class="kw">dim</span>(triangles)[1L]</a>
<a class="sourceLine" id="cb1-146" title="146">  indices &lt;-<span class="st"> </span><span class="kw">matrix</span>(1L<span class="op">:</span>(3L<span class="op">*</span>ntriangles), <span class="dt">nrow =</span> 3L, <span class="dt">ncol =</span> ntriangles)</a>
<a class="sourceLine" id="cb1-147" title="147">  vertices &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_real_</span>, <span class="dt">nrow =</span> 3L, <span class="dt">ncol =</span> 3L<span class="op">*</span>ntriangles)</a>
<a class="sourceLine" id="cb1-148" title="148">  <span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span>ntriangles){</a>
<a class="sourceLine" id="cb1-149" title="149">    trgl &lt;-<span class="st"> </span>triangles[i,,]</a>
<a class="sourceLine" id="cb1-150" title="150">    vertices[, 3L<span class="op">*</span>(i<span class="op">-</span>1L)<span class="op">+</span>1L] &lt;-<span class="st"> </span><span class="kw">sproj</span>(trgl[1L,], r)</a>
<a class="sourceLine" id="cb1-151" title="151">    vertices[, 3L<span class="op">*</span>(i<span class="op">-</span>1L)<span class="op">+</span>2L] &lt;-<span class="st"> </span><span class="kw">sproj</span>(trgl[2L,], r)</a>
<a class="sourceLine" id="cb1-152" title="152">    vertices[, 3L<span class="op">*</span>(i<span class="op">-</span>1L)<span class="op">+</span>3L] &lt;-<span class="st"> </span><span class="kw">sproj</span>(trgl[3L,], r)</a>
<a class="sourceLine" id="cb1-153" title="153">  }</a>
<a class="sourceLine" id="cb1-154" title="154">  mesh &lt;-<span class="st"> </span><span class="kw">tmesh3d</span>(vertices, indices, <span class="dt">homogeneous =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-155" title="155">  Rvcg<span class="op">::</span><span class="kw">vcgClean</span>(mesh, <span class="dt">sel =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">7</span>), <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-156" title="156">}</a>
<a class="sourceLine" id="cb1-157" title="157"></a>
<a class="sourceLine" id="cb1-158" title="158"><span class="co"># projected vertices ###########################################################</span></a>
<a class="sourceLine" id="cb1-159" title="159">r &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>sqr2p1<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-160" title="160">vs &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(vertices, 1L, <span class="cf">function</span>(M){<span class="kw">sproj</span>(M, r)}))</a>
<a class="sourceLine" id="cb1-161" title="161"></a>
<a class="sourceLine" id="cb1-162" title="162"><span class="co">####~~~~ plot ~~~~##############################################################</span></a>
<a class="sourceLine" id="cb1-163" title="163"><span class="kw">open3d</span>(<span class="dt">windowRect =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">562</span>, <span class="dv">562</span>), <span class="dt">zoom =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb1-164" title="164"><span class="kw">bg3d</span>(<span class="kw">rgb</span>(<span class="dv">54</span>, <span class="dv">57</span>, <span class="dv">64</span>, <span class="dt">maxColorValue =</span> <span class="dv">255</span>))</a>
<a class="sourceLine" id="cb1-165" title="165"><span class="co">## plot the edges</span></a>
<a class="sourceLine" id="cb1-166" title="166"><span class="cf">for</span>(k <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(edges)){</a>
<a class="sourceLine" id="cb1-167" title="167">  edge &lt;-<span class="st"> </span><span class="kw">stereoEdge</span>(vertices, edges[k,], r, <span class="dt">n =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1-168" title="168">  <span class="kw">shade3d</span>(edge, <span class="dt">color =</span> <span class="st">&quot;gold&quot;</span>)</a>
<a class="sourceLine" id="cb1-169" title="169">}</a>
<a class="sourceLine" id="cb1-170" title="170"><span class="co">## plot the vertices</span></a>
<a class="sourceLine" id="cb1-171" title="171"><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(vs)){</a>
<a class="sourceLine" id="cb1-172" title="172">  v &lt;-<span class="st"> </span>vs[i,]</a>
<a class="sourceLine" id="cb1-173" title="173">  <span class="kw">spheres3d</span>(v, <span class="dt">radius =</span> <span class="kw">log1p</span>(<span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(v)))<span class="op">/</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;gold2&quot;</span>)</a>
<a class="sourceLine" id="cb1-174" title="174">}</a>
<a class="sourceLine" id="cb1-175" title="175"><span class="co">## plot the filled triangles</span></a>
<a class="sourceLine" id="cb1-176" title="176"><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(triangles)){</a>
<a class="sourceLine" id="cb1-177" title="177">  trgl &lt;-<span class="st"> </span>triangles[i,]</a>
<a class="sourceLine" id="cb1-178" title="178">  A &lt;-<span class="st"> </span>vertices[trgl[1L], ]</a>
<a class="sourceLine" id="cb1-179" title="179">  B &lt;-<span class="st"> </span>vertices[trgl[2L], ]</a>
<a class="sourceLine" id="cb1-180" title="180">  C &lt;-<span class="st"> </span>vertices[trgl[3L], ]</a>
<a class="sourceLine" id="cb1-181" title="181">  mesh &lt;-<span class="st"> </span><span class="kw">stereoTriangle</span>(<span class="dv">6</span>, A, B, C, r)</a>
<a class="sourceLine" id="cb1-182" title="182">  <span class="kw">shade3d</span>(mesh, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb1-183" title="183">}</a></code></pre></div>
<p><img src="figures/truncatedTesseract_stereographic_rgl.gif" /></p>
<h1 id="drawing-with-asymptote">Drawing with Asymptote</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb2-1" title="1">settings.render = <span class="dv">4</span>;</a>
<a class="sourceLine" id="cb2-2" title="2">settings.outformat = <span class="st">&quot;eps&quot;</span>;</a>
<a class="sourceLine" id="cb2-3" title="3">import tube;</a>
<a class="sourceLine" id="cb2-4" title="4">size(<span class="dv">200</span>,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6">currentprojection = orthographic(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>);</a>
<a class="sourceLine" id="cb2-7" title="7">currentlight = light(gray(<span class="fl">0.85</span>), ambient=black, specularfactor=<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb2-8" title="8">                     (<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>), specular=gray(<span class="fl">0.9</span>), viewport=<span class="kw">false</span>);</a>
<a class="sourceLine" id="cb2-9" title="9">currentlight.background = rgb(<span class="st">&quot;363940ff&quot;</span>);</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">// files to be saved -----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-12" title="12">string[] files = {</a>
<a class="sourceLine" id="cb2-13" title="13">    <span class="st">&quot;TT000&quot;</span>, <span class="st">&quot;TT001&quot;</span>, <span class="st">&quot;TT002&quot;</span>, <span class="st">&quot;TT003&quot;</span>, <span class="st">&quot;TT004&quot;</span>, <span class="st">&quot;TT005&quot;</span>,</a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="st">&quot;TT006&quot;</span>, <span class="st">&quot;TT007&quot;</span>, <span class="st">&quot;TT008&quot;</span>, <span class="st">&quot;TT009&quot;</span>, <span class="st">&quot;TT010&quot;</span>, <span class="st">&quot;TT011&quot;</span>,</a>
<a class="sourceLine" id="cb2-15" title="15">    <span class="st">&quot;TT012&quot;</span>, <span class="st">&quot;TT013&quot;</span>, <span class="st">&quot;TT014&quot;</span>, <span class="st">&quot;TT015&quot;</span>, <span class="st">&quot;TT016&quot;</span>, <span class="st">&quot;TT017&quot;</span>,</a>
<a class="sourceLine" id="cb2-16" title="16">    <span class="st">&quot;TT018&quot;</span>, <span class="st">&quot;TT019&quot;</span>, <span class="st">&quot;TT020&quot;</span>, <span class="st">&quot;TT021&quot;</span>, <span class="st">&quot;TT022&quot;</span>, <span class="st">&quot;TT023&quot;</span>,</a>
<a class="sourceLine" id="cb2-17" title="17">    <span class="st">&quot;TT024&quot;</span>, <span class="st">&quot;TT025&quot;</span>, <span class="st">&quot;TT026&quot;</span>, <span class="st">&quot;TT027&quot;</span>, <span class="st">&quot;TT028&quot;</span>, <span class="st">&quot;TT029&quot;</span>,</a>
<a class="sourceLine" id="cb2-18" title="18">    <span class="st">&quot;TT030&quot;</span>, <span class="st">&quot;TT031&quot;</span>, <span class="st">&quot;TT032&quot;</span>, <span class="st">&quot;TT033&quot;</span>, <span class="st">&quot;TT034&quot;</span>, <span class="st">&quot;TT035&quot;</span>,</a>
<a class="sourceLine" id="cb2-19" title="19">    <span class="st">&quot;TT036&quot;</span>, <span class="st">&quot;TT037&quot;</span>, <span class="st">&quot;TT038&quot;</span>, <span class="st">&quot;TT039&quot;</span>, <span class="st">&quot;TT040&quot;</span>, <span class="st">&quot;TT041&quot;</span>,</a>
<a class="sourceLine" id="cb2-20" title="20">    <span class="st">&quot;TT042&quot;</span>, <span class="st">&quot;TT043&quot;</span>, <span class="st">&quot;TT044&quot;</span>, <span class="st">&quot;TT045&quot;</span>, <span class="st">&quot;TT046&quot;</span>, <span class="st">&quot;TT047&quot;</span>,</a>
<a class="sourceLine" id="cb2-21" title="21">    <span class="st">&quot;TT048&quot;</span>, <span class="st">&quot;TT049&quot;</span>, <span class="st">&quot;TT050&quot;</span>, <span class="st">&quot;TT051&quot;</span>, <span class="st">&quot;TT052&quot;</span>, <span class="st">&quot;TT053&quot;</span>,</a>
<a class="sourceLine" id="cb2-22" title="22">    <span class="st">&quot;TT054&quot;</span>, <span class="st">&quot;TT055&quot;</span>, <span class="st">&quot;TT056&quot;</span>, <span class="st">&quot;TT057&quot;</span>, <span class="st">&quot;TT058&quot;</span>, <span class="st">&quot;TT059&quot;</span>,</a>
<a class="sourceLine" id="cb2-23" title="23">    <span class="st">&quot;TT060&quot;</span>, <span class="st">&quot;TT061&quot;</span>, <span class="st">&quot;TT062&quot;</span>, <span class="st">&quot;TT063&quot;</span>, <span class="st">&quot;TT064&quot;</span>, <span class="st">&quot;TT065&quot;</span>,</a>
<a class="sourceLine" id="cb2-24" title="24">    <span class="st">&quot;TT066&quot;</span>, <span class="st">&quot;TT067&quot;</span>, <span class="st">&quot;TT068&quot;</span>, <span class="st">&quot;TT069&quot;</span>, <span class="st">&quot;TT070&quot;</span>, <span class="st">&quot;TT071&quot;</span>,</a>
<a class="sourceLine" id="cb2-25" title="25">    <span class="st">&quot;TT072&quot;</span>, <span class="st">&quot;TT073&quot;</span>, <span class="st">&quot;TT074&quot;</span>, <span class="st">&quot;TT075&quot;</span>, <span class="st">&quot;TT076&quot;</span>, <span class="st">&quot;TT077&quot;</span>,</a>
<a class="sourceLine" id="cb2-26" title="26">    <span class="st">&quot;TT078&quot;</span>, <span class="st">&quot;TT079&quot;</span>, <span class="st">&quot;TT080&quot;</span>, <span class="st">&quot;TT081&quot;</span>, <span class="st">&quot;TT082&quot;</span>, <span class="st">&quot;TT083&quot;</span>,</a>
<a class="sourceLine" id="cb2-27" title="27">    <span class="st">&quot;TT084&quot;</span>, <span class="st">&quot;TT085&quot;</span>, <span class="st">&quot;TT086&quot;</span>, <span class="st">&quot;TT087&quot;</span>, <span class="st">&quot;TT088&quot;</span>, <span class="st">&quot;TT089&quot;</span>,</a>
<a class="sourceLine" id="cb2-28" title="28">    <span class="st">&quot;TT090&quot;</span>, <span class="st">&quot;TT091&quot;</span>, <span class="st">&quot;TT092&quot;</span>, <span class="st">&quot;TT093&quot;</span>, <span class="st">&quot;TT094&quot;</span>, <span class="st">&quot;TT095&quot;</span>,</a>
<a class="sourceLine" id="cb2-29" title="29">    <span class="st">&quot;TT096&quot;</span>, <span class="st">&quot;TT097&quot;</span>, <span class="st">&quot;TT098&quot;</span>, <span class="st">&quot;TT099&quot;</span>, <span class="st">&quot;TT100&quot;</span>, <span class="st">&quot;TT101&quot;</span>,</a>
<a class="sourceLine" id="cb2-30" title="30">    <span class="st">&quot;TT102&quot;</span>, <span class="st">&quot;TT103&quot;</span>, <span class="st">&quot;TT104&quot;</span>, <span class="st">&quot;TT105&quot;</span>, <span class="st">&quot;TT106&quot;</span>, <span class="st">&quot;TT107&quot;</span>,</a>
<a class="sourceLine" id="cb2-31" title="31">    <span class="st">&quot;TT108&quot;</span>, <span class="st">&quot;TT109&quot;</span>, <span class="st">&quot;TT110&quot;</span>, <span class="st">&quot;TT111&quot;</span>, <span class="st">&quot;TT112&quot;</span>, <span class="st">&quot;TT113&quot;</span>,</a>
<a class="sourceLine" id="cb2-32" title="32">    <span class="st">&quot;TT114&quot;</span>, <span class="st">&quot;TT115&quot;</span>, <span class="st">&quot;TT116&quot;</span>, <span class="st">&quot;TT117&quot;</span>, <span class="st">&quot;TT118&quot;</span>, <span class="st">&quot;TT119&quot;</span>,</a>
<a class="sourceLine" id="cb2-33" title="33">    <span class="st">&quot;TT120&quot;</span>, <span class="st">&quot;TT121&quot;</span>, <span class="st">&quot;TT122&quot;</span>, <span class="st">&quot;TT123&quot;</span>, <span class="st">&quot;TT124&quot;</span>, <span class="st">&quot;TT125&quot;</span>,</a>
<a class="sourceLine" id="cb2-34" title="34">    <span class="st">&quot;TT126&quot;</span>, <span class="st">&quot;TT127&quot;</span>, <span class="st">&quot;TT128&quot;</span>, <span class="st">&quot;TT129&quot;</span>, <span class="st">&quot;TT130&quot;</span>, <span class="st">&quot;TT131&quot;</span>,</a>
<a class="sourceLine" id="cb2-35" title="35">    <span class="st">&quot;TT132&quot;</span>, <span class="st">&quot;TT133&quot;</span>, <span class="st">&quot;TT134&quot;</span>, <span class="st">&quot;TT135&quot;</span>, <span class="st">&quot;TT136&quot;</span>, <span class="st">&quot;TT137&quot;</span>,</a>
<a class="sourceLine" id="cb2-36" title="36">    <span class="st">&quot;TT138&quot;</span>, <span class="st">&quot;TT139&quot;</span>, <span class="st">&quot;TT140&quot;</span>, <span class="st">&quot;TT141&quot;</span>, <span class="st">&quot;TT142&quot;</span>, <span class="st">&quot;TT143&quot;</span>,</a>
<a class="sourceLine" id="cb2-37" title="37">    <span class="st">&quot;TT144&quot;</span>, <span class="st">&quot;TT145&quot;</span>, <span class="st">&quot;TT146&quot;</span>, <span class="st">&quot;TT147&quot;</span>, <span class="st">&quot;TT148&quot;</span>, <span class="st">&quot;TT149&quot;</span>,</a>
<a class="sourceLine" id="cb2-38" title="38">    <span class="st">&quot;TT150&quot;</span>, <span class="st">&quot;TT151&quot;</span>, <span class="st">&quot;TT152&quot;</span>, <span class="st">&quot;TT153&quot;</span>, <span class="st">&quot;TT154&quot;</span>, <span class="st">&quot;TT155&quot;</span>,</a>
<a class="sourceLine" id="cb2-39" title="39">    <span class="st">&quot;TT156&quot;</span>, <span class="st">&quot;TT157&quot;</span>, <span class="st">&quot;TT158&quot;</span>, <span class="st">&quot;TT159&quot;</span>, <span class="st">&quot;TT160&quot;</span>, <span class="st">&quot;TT161&quot;</span>,</a>
<a class="sourceLine" id="cb2-40" title="40">    <span class="st">&quot;TT162&quot;</span>, <span class="st">&quot;TT163&quot;</span>, <span class="st">&quot;TT164&quot;</span>, <span class="st">&quot;TT165&quot;</span>, <span class="st">&quot;TT166&quot;</span>, <span class="st">&quot;TT167&quot;</span>,</a>
<a class="sourceLine" id="cb2-41" title="41">    <span class="st">&quot;TT168&quot;</span>, <span class="st">&quot;TT169&quot;</span>, <span class="st">&quot;TT170&quot;</span>, <span class="st">&quot;TT171&quot;</span>, <span class="st">&quot;TT172&quot;</span>, <span class="st">&quot;TT173&quot;</span>,</a>
<a class="sourceLine" id="cb2-42" title="42">    <span class="st">&quot;TT174&quot;</span>, <span class="st">&quot;TT175&quot;</span>, <span class="st">&quot;TT176&quot;</span>, <span class="st">&quot;TT177&quot;</span>, <span class="st">&quot;TT178&quot;</span>, <span class="st">&quot;TT179&quot;</span>};</a>
<a class="sourceLine" id="cb2-43" title="43"></a>
<a class="sourceLine" id="cb2-44" title="44"><span class="co">// vertices --------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-45" title="45"><span class="kw">struct</span> quadruple {</a>
<a class="sourceLine" id="cb2-46" title="46">    real x;</a>
<a class="sourceLine" id="cb2-47" title="47">    real y;</a>
<a class="sourceLine" id="cb2-48" title="48">    real z;</a>
<a class="sourceLine" id="cb2-49" title="49">    real t;</a>
<a class="sourceLine" id="cb2-50" title="50">}</a>
<a class="sourceLine" id="cb2-51" title="51"></a>
<a class="sourceLine" id="cb2-52" title="52">quadruple array2quadruple(real[] v){</a>
<a class="sourceLine" id="cb2-53" title="53">    quadruple q;</a>
<a class="sourceLine" id="cb2-54" title="54">    q.x = v[<span class="dv">0</span>]; q.y = v[<span class="dv">1</span>]; q.z = v[<span class="dv">2</span>]; q.t = v[<span class="dv">3</span>];</a>
<a class="sourceLine" id="cb2-55" title="55">    <span class="cf">return</span> q;</a>
<a class="sourceLine" id="cb2-56" title="56">}</a>
<a class="sourceLine" id="cb2-57" title="57"></a>
<a class="sourceLine" id="cb2-58" title="58">real x = <span class="dv">1</span> + sqrt(<span class="dv">2</span>);</a>
<a class="sourceLine" id="cb2-59" title="59">real r = sqrt(<span class="dv">1</span> + <span class="dv">3</span> * x * x);</a>
<a class="sourceLine" id="cb2-60" title="60">real[][] vertices0 = {</a>
<a class="sourceLine" id="cb2-61" title="61">    {-<span class="fl">1.0</span>, -x, -x, -x},</a>
<a class="sourceLine" id="cb2-62" title="62">    {-<span class="fl">1.0</span>, -x, -x, x},</a>
<a class="sourceLine" id="cb2-63" title="63">    {-<span class="fl">1.0</span>, -x, x, -x},</a>
<a class="sourceLine" id="cb2-64" title="64">    {-<span class="fl">1.0</span>, -x, x, x},</a>
<a class="sourceLine" id="cb2-65" title="65">    {-<span class="fl">1.0</span>, x, -x, -x},</a>
<a class="sourceLine" id="cb2-66" title="66">    {-<span class="fl">1.0</span>, x, -x, x},</a>
<a class="sourceLine" id="cb2-67" title="67">    {-<span class="fl">1.0</span>, x, x, -x},</a>
<a class="sourceLine" id="cb2-68" title="68">    {-<span class="fl">1.0</span>, x, x, x},</a>
<a class="sourceLine" id="cb2-69" title="69">    {<span class="fl">1.0</span>, -x, -x, -x},</a>
<a class="sourceLine" id="cb2-70" title="70">    {<span class="fl">1.0</span>, -x, -x, x},</a>
<a class="sourceLine" id="cb2-71" title="71">    {<span class="fl">1.0</span>, -x, x, -x},</a>
<a class="sourceLine" id="cb2-72" title="72">    {<span class="fl">1.0</span>, -x, x, x},</a>
<a class="sourceLine" id="cb2-73" title="73">    {<span class="fl">1.0</span>, x, -x, -x},</a>
<a class="sourceLine" id="cb2-74" title="74">    {<span class="fl">1.0</span>, x, -x, x},</a>
<a class="sourceLine" id="cb2-75" title="75">    {<span class="fl">1.0</span>, x, x, -x},</a>
<a class="sourceLine" id="cb2-76" title="76">    {<span class="fl">1.0</span>, x, x, x},</a>
<a class="sourceLine" id="cb2-77" title="77">    {-x, -<span class="fl">1.0</span>, -x, -x},</a>
<a class="sourceLine" id="cb2-78" title="78">    {-x, -<span class="fl">1.0</span>, -x, x},</a>
<a class="sourceLine" id="cb2-79" title="79">    {-x, -<span class="fl">1.0</span>, x, -x},</a>
<a class="sourceLine" id="cb2-80" title="80">    {-x, -<span class="fl">1.0</span>, x, x},</a>
<a class="sourceLine" id="cb2-81" title="81">    {-x, <span class="fl">1.0</span>, -x, -x},</a>
<a class="sourceLine" id="cb2-82" title="82">    {-x, <span class="fl">1.0</span>, -x, x},</a>
<a class="sourceLine" id="cb2-83" title="83">    {-x, <span class="fl">1.0</span>, x, -x},</a>
<a class="sourceLine" id="cb2-84" title="84">    {-x, <span class="fl">1.0</span>, x, x},</a>
<a class="sourceLine" id="cb2-85" title="85">    {x, -<span class="fl">1.0</span>, -x, -x},</a>
<a class="sourceLine" id="cb2-86" title="86">    {x, -<span class="fl">1.0</span>, -x, x},</a>
<a class="sourceLine" id="cb2-87" title="87">    {x, -<span class="fl">1.0</span>, x, -x},</a>
<a class="sourceLine" id="cb2-88" title="88">    {x, -<span class="fl">1.0</span>, x, x},</a>
<a class="sourceLine" id="cb2-89" title="89">    {x, <span class="fl">1.0</span>, -x, -x},</a>
<a class="sourceLine" id="cb2-90" title="90">    {x, <span class="fl">1.0</span>, -x, x},</a>
<a class="sourceLine" id="cb2-91" title="91">    {x, <span class="fl">1.0</span>, x, -x},</a>
<a class="sourceLine" id="cb2-92" title="92">    {x, <span class="fl">1.0</span>, x, x},</a>
<a class="sourceLine" id="cb2-93" title="93">    {-x, -x, -<span class="fl">1.0</span>, -x},</a>
<a class="sourceLine" id="cb2-94" title="94">    {-x, -x, -<span class="fl">1.0</span>, x},</a>
<a class="sourceLine" id="cb2-95" title="95">    {-x, -x, <span class="fl">1.0</span>, -x},</a>
<a class="sourceLine" id="cb2-96" title="96">    {-x, -x, <span class="fl">1.0</span>, x},</a>
<a class="sourceLine" id="cb2-97" title="97">    {-x, x, -<span class="fl">1.0</span>, -x},</a>
<a class="sourceLine" id="cb2-98" title="98">    {-x, x, -<span class="fl">1.0</span>, x},</a>
<a class="sourceLine" id="cb2-99" title="99">    {-x, x, <span class="fl">1.0</span>, -x},</a>
<a class="sourceLine" id="cb2-100" title="100">    {-x, x, <span class="fl">1.0</span>, x},</a>
<a class="sourceLine" id="cb2-101" title="101">    {x, -x, -<span class="fl">1.0</span>, -x},</a>
<a class="sourceLine" id="cb2-102" title="102">    {x, -x, -<span class="fl">1.0</span>, x},</a>
<a class="sourceLine" id="cb2-103" title="103">    {x, -x, <span class="fl">1.0</span>, -x},</a>
<a class="sourceLine" id="cb2-104" title="104">    {x, -x, <span class="fl">1.0</span>, x},</a>
<a class="sourceLine" id="cb2-105" title="105">    {x, x, -<span class="fl">1.0</span>, -x},</a>
<a class="sourceLine" id="cb2-106" title="106">    {x, x, -<span class="fl">1.0</span>, x},</a>
<a class="sourceLine" id="cb2-107" title="107">    {x, x, <span class="fl">1.0</span>, -x},</a>
<a class="sourceLine" id="cb2-108" title="108">    {x, x, <span class="fl">1.0</span>, x},</a>
<a class="sourceLine" id="cb2-109" title="109">    {-x, -x, -x, -<span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-110" title="110">    {-x, -x, -x, <span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-111" title="111">    {-x, -x, x, -<span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-112" title="112">    {-x, -x, x, <span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-113" title="113">    {-x, x, -x, -<span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-114" title="114">    {-x, x, -x, <span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-115" title="115">    {-x, x, x, -<span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-116" title="116">    {-x, x, x, <span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-117" title="117">    {x, -x, -x, -<span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-118" title="118">    {x, -x, -x, <span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-119" title="119">    {x, -x, x, -<span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-120" title="120">    {x, -x, x, <span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-121" title="121">    {x, x, -x, -<span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-122" title="122">    {x, x, -x, <span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-123" title="123">    {x, x, x, -<span class="fl">1.0</span>},</a>
<a class="sourceLine" id="cb2-124" title="124">    {x, x, x, <span class="fl">1.0</span>} };</a>
<a class="sourceLine" id="cb2-125" title="125">    </a>
<a class="sourceLine" id="cb2-126" title="126">quadruple[] vertices = <span class="kw">new</span> quadruple[vertices0.length];</a>
<a class="sourceLine" id="cb2-127" title="127"><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; vertices0.length; ++i){</a>
<a class="sourceLine" id="cb2-128" title="128">    vertices[i] = array2quadruple(vertices0[i]);</a>
<a class="sourceLine" id="cb2-129" title="129">}</a>
<a class="sourceLine" id="cb2-130" title="130"></a>
<a class="sourceLine" id="cb2-131" title="131"><span class="co">// edges -----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-132" title="132"><span class="dt">int</span>[][] edges = {</a>
<a class="sourceLine" id="cb2-133" title="133">    {<span class="dv">0</span>, <span class="dv">8</span>},</a>
<a class="sourceLine" id="cb2-134" title="134">    {<span class="dv">0</span>, <span class="dv">16</span>},</a>
<a class="sourceLine" id="cb2-135" title="135">    {<span class="dv">0</span>, <span class="dv">32</span>},</a>
<a class="sourceLine" id="cb2-136" title="136">    {<span class="dv">0</span>, <span class="dv">48</span>},</a>
<a class="sourceLine" id="cb2-137" title="137">    {<span class="dv">1</span>, <span class="dv">9</span>},</a>
<a class="sourceLine" id="cb2-138" title="138">    {<span class="dv">1</span>, <span class="dv">17</span>},</a>
<a class="sourceLine" id="cb2-139" title="139">    {<span class="dv">1</span>, <span class="dv">33</span>},</a>
<a class="sourceLine" id="cb2-140" title="140">    {<span class="dv">1</span>, <span class="dv">49</span>},</a>
<a class="sourceLine" id="cb2-141" title="141">    {<span class="dv">2</span>, <span class="dv">10</span>},</a>
<a class="sourceLine" id="cb2-142" title="142">    {<span class="dv">2</span>, <span class="dv">18</span>},</a>
<a class="sourceLine" id="cb2-143" title="143">    {<span class="dv">2</span>, <span class="dv">34</span>},</a>
<a class="sourceLine" id="cb2-144" title="144">    {<span class="dv">2</span>, <span class="dv">50</span>},</a>
<a class="sourceLine" id="cb2-145" title="145">    {<span class="dv">3</span>, <span class="dv">11</span>},</a>
<a class="sourceLine" id="cb2-146" title="146">    {<span class="dv">3</span>, <span class="dv">19</span>},</a>
<a class="sourceLine" id="cb2-147" title="147">    {<span class="dv">3</span>, <span class="dv">35</span>},</a>
<a class="sourceLine" id="cb2-148" title="148">    {<span class="dv">3</span>, <span class="dv">51</span>},</a>
<a class="sourceLine" id="cb2-149" title="149">    {<span class="dv">4</span>, <span class="dv">12</span>},</a>
<a class="sourceLine" id="cb2-150" title="150">    {<span class="dv">4</span>, <span class="dv">20</span>},</a>
<a class="sourceLine" id="cb2-151" title="151">    {<span class="dv">4</span>, <span class="dv">36</span>},</a>
<a class="sourceLine" id="cb2-152" title="152">    {<span class="dv">4</span>, <span class="dv">52</span>},</a>
<a class="sourceLine" id="cb2-153" title="153">    {<span class="dv">5</span>, <span class="dv">13</span>},</a>
<a class="sourceLine" id="cb2-154" title="154">    {<span class="dv">5</span>, <span class="dv">21</span>},</a>
<a class="sourceLine" id="cb2-155" title="155">    {<span class="dv">5</span>, <span class="dv">37</span>},</a>
<a class="sourceLine" id="cb2-156" title="156">    {<span class="dv">5</span>, <span class="dv">53</span>},</a>
<a class="sourceLine" id="cb2-157" title="157">    {<span class="dv">6</span>, <span class="dv">14</span>},</a>
<a class="sourceLine" id="cb2-158" title="158">    {<span class="dv">6</span>, <span class="dv">22</span>},</a>
<a class="sourceLine" id="cb2-159" title="159">    {<span class="dv">6</span>, <span class="dv">38</span>},</a>
<a class="sourceLine" id="cb2-160" title="160">    {<span class="dv">6</span>, <span class="dv">54</span>},</a>
<a class="sourceLine" id="cb2-161" title="161">    {<span class="dv">7</span>, <span class="dv">15</span>},</a>
<a class="sourceLine" id="cb2-162" title="162">    {<span class="dv">7</span>, <span class="dv">23</span>},</a>
<a class="sourceLine" id="cb2-163" title="163">    {<span class="dv">7</span>, <span class="dv">39</span>},</a>
<a class="sourceLine" id="cb2-164" title="164">    {<span class="dv">7</span>, <span class="dv">55</span>},</a>
<a class="sourceLine" id="cb2-165" title="165">    {<span class="dv">8</span>, <span class="dv">24</span>},</a>
<a class="sourceLine" id="cb2-166" title="166">    {<span class="dv">8</span>, <span class="dv">40</span>},</a>
<a class="sourceLine" id="cb2-167" title="167">    {<span class="dv">8</span>, <span class="dv">56</span>},</a>
<a class="sourceLine" id="cb2-168" title="168">    {<span class="dv">9</span>, <span class="dv">25</span>},</a>
<a class="sourceLine" id="cb2-169" title="169">    {<span class="dv">9</span>, <span class="dv">41</span>},</a>
<a class="sourceLine" id="cb2-170" title="170">    {<span class="dv">9</span>, <span class="dv">57</span>},</a>
<a class="sourceLine" id="cb2-171" title="171">    {<span class="dv">10</span>, <span class="dv">26</span>},</a>
<a class="sourceLine" id="cb2-172" title="172">    {<span class="dv">10</span>, <span class="dv">42</span>},</a>
<a class="sourceLine" id="cb2-173" title="173">    {<span class="dv">10</span>, <span class="dv">58</span>},</a>
<a class="sourceLine" id="cb2-174" title="174">    {<span class="dv">11</span>, <span class="dv">27</span>},</a>
<a class="sourceLine" id="cb2-175" title="175">    {<span class="dv">11</span>, <span class="dv">43</span>},</a>
<a class="sourceLine" id="cb2-176" title="176">    {<span class="dv">11</span>, <span class="dv">59</span>},</a>
<a class="sourceLine" id="cb2-177" title="177">    {<span class="dv">12</span>, <span class="dv">28</span>},</a>
<a class="sourceLine" id="cb2-178" title="178">    {<span class="dv">12</span>, <span class="dv">44</span>},</a>
<a class="sourceLine" id="cb2-179" title="179">    {<span class="dv">12</span>, <span class="dv">60</span>},</a>
<a class="sourceLine" id="cb2-180" title="180">    {<span class="dv">13</span>, <span class="dv">29</span>},</a>
<a class="sourceLine" id="cb2-181" title="181">    {<span class="dv">13</span>, <span class="dv">45</span>},</a>
<a class="sourceLine" id="cb2-182" title="182">    {<span class="dv">13</span>, <span class="dv">61</span>},</a>
<a class="sourceLine" id="cb2-183" title="183">    {<span class="dv">14</span>, <span class="dv">30</span>},</a>
<a class="sourceLine" id="cb2-184" title="184">    {<span class="dv">14</span>, <span class="dv">46</span>},</a>
<a class="sourceLine" id="cb2-185" title="185">    {<span class="dv">14</span>, <span class="dv">62</span>},</a>
<a class="sourceLine" id="cb2-186" title="186">    {<span class="dv">15</span>, <span class="dv">31</span>},</a>
<a class="sourceLine" id="cb2-187" title="187">    {<span class="dv">15</span>, <span class="dv">47</span>},</a>
<a class="sourceLine" id="cb2-188" title="188">    {<span class="dv">15</span>, <span class="dv">63</span>},</a>
<a class="sourceLine" id="cb2-189" title="189">    {<span class="dv">16</span>, <span class="dv">20</span>},</a>
<a class="sourceLine" id="cb2-190" title="190">    {<span class="dv">16</span>, <span class="dv">32</span>},</a>
<a class="sourceLine" id="cb2-191" title="191">    {<span class="dv">16</span>, <span class="dv">48</span>},</a>
<a class="sourceLine" id="cb2-192" title="192">    {<span class="dv">17</span>, <span class="dv">21</span>},</a>
<a class="sourceLine" id="cb2-193" title="193">    {<span class="dv">17</span>, <span class="dv">33</span>},</a>
<a class="sourceLine" id="cb2-194" title="194">    {<span class="dv">17</span>, <span class="dv">49</span>},</a>
<a class="sourceLine" id="cb2-195" title="195">    {<span class="dv">18</span>, <span class="dv">22</span>},</a>
<a class="sourceLine" id="cb2-196" title="196">    {<span class="dv">18</span>, <span class="dv">34</span>},</a>
<a class="sourceLine" id="cb2-197" title="197">    {<span class="dv">18</span>, <span class="dv">50</span>},</a>
<a class="sourceLine" id="cb2-198" title="198">    {<span class="dv">19</span>, <span class="dv">23</span>},</a>
<a class="sourceLine" id="cb2-199" title="199">    {<span class="dv">19</span>, <span class="dv">35</span>},</a>
<a class="sourceLine" id="cb2-200" title="200">    {<span class="dv">19</span>, <span class="dv">51</span>},</a>
<a class="sourceLine" id="cb2-201" title="201">    {<span class="dv">20</span>, <span class="dv">36</span>},</a>
<a class="sourceLine" id="cb2-202" title="202">    {<span class="dv">20</span>, <span class="dv">52</span>},</a>
<a class="sourceLine" id="cb2-203" title="203">    {<span class="dv">21</span>, <span class="dv">37</span>},</a>
<a class="sourceLine" id="cb2-204" title="204">    {<span class="dv">21</span>, <span class="dv">53</span>},</a>
<a class="sourceLine" id="cb2-205" title="205">    {<span class="dv">22</span>, <span class="dv">38</span>},</a>
<a class="sourceLine" id="cb2-206" title="206">    {<span class="dv">22</span>, <span class="dv">54</span>},</a>
<a class="sourceLine" id="cb2-207" title="207">    {<span class="dv">23</span>, <span class="dv">39</span>},</a>
<a class="sourceLine" id="cb2-208" title="208">    {<span class="dv">23</span>, <span class="dv">55</span>},</a>
<a class="sourceLine" id="cb2-209" title="209">    {<span class="dv">24</span>, <span class="dv">28</span>},</a>
<a class="sourceLine" id="cb2-210" title="210">    {<span class="dv">24</span>, <span class="dv">40</span>},</a>
<a class="sourceLine" id="cb2-211" title="211">    {<span class="dv">24</span>, <span class="dv">56</span>},</a>
<a class="sourceLine" id="cb2-212" title="212">    {<span class="dv">25</span>, <span class="dv">29</span>},</a>
<a class="sourceLine" id="cb2-213" title="213">    {<span class="dv">25</span>, <span class="dv">41</span>},</a>
<a class="sourceLine" id="cb2-214" title="214">    {<span class="dv">25</span>, <span class="dv">57</span>},</a>
<a class="sourceLine" id="cb2-215" title="215">    {<span class="dv">26</span>, <span class="dv">30</span>},</a>
<a class="sourceLine" id="cb2-216" title="216">    {<span class="dv">26</span>, <span class="dv">42</span>},</a>
<a class="sourceLine" id="cb2-217" title="217">    {<span class="dv">26</span>, <span class="dv">58</span>},</a>
<a class="sourceLine" id="cb2-218" title="218">    {<span class="dv">27</span>, <span class="dv">31</span>},</a>
<a class="sourceLine" id="cb2-219" title="219">    {<span class="dv">27</span>, <span class="dv">43</span>},</a>
<a class="sourceLine" id="cb2-220" title="220">    {<span class="dv">27</span>, <span class="dv">59</span>},</a>
<a class="sourceLine" id="cb2-221" title="221">    {<span class="dv">28</span>, <span class="dv">44</span>},</a>
<a class="sourceLine" id="cb2-222" title="222">    {<span class="dv">28</span>, <span class="dv">60</span>},</a>
<a class="sourceLine" id="cb2-223" title="223">    {<span class="dv">29</span>, <span class="dv">45</span>},</a>
<a class="sourceLine" id="cb2-224" title="224">    {<span class="dv">29</span>, <span class="dv">61</span>},</a>
<a class="sourceLine" id="cb2-225" title="225">    {<span class="dv">30</span>, <span class="dv">46</span>},</a>
<a class="sourceLine" id="cb2-226" title="226">    {<span class="dv">30</span>, <span class="dv">62</span>},</a>
<a class="sourceLine" id="cb2-227" title="227">    {<span class="dv">31</span>, <span class="dv">47</span>},</a>
<a class="sourceLine" id="cb2-228" title="228">    {<span class="dv">31</span>, <span class="dv">63</span>},</a>
<a class="sourceLine" id="cb2-229" title="229">    {<span class="dv">32</span>, <span class="dv">34</span>},</a>
<a class="sourceLine" id="cb2-230" title="230">    {<span class="dv">32</span>, <span class="dv">48</span>},</a>
<a class="sourceLine" id="cb2-231" title="231">    {<span class="dv">33</span>, <span class="dv">35</span>},</a>
<a class="sourceLine" id="cb2-232" title="232">    {<span class="dv">33</span>, <span class="dv">49</span>},</a>
<a class="sourceLine" id="cb2-233" title="233">    {<span class="dv">34</span>, <span class="dv">50</span>},</a>
<a class="sourceLine" id="cb2-234" title="234">    {<span class="dv">35</span>, <span class="dv">51</span>},</a>
<a class="sourceLine" id="cb2-235" title="235">    {<span class="dv">36</span>, <span class="dv">38</span>},</a>
<a class="sourceLine" id="cb2-236" title="236">    {<span class="dv">36</span>, <span class="dv">52</span>},</a>
<a class="sourceLine" id="cb2-237" title="237">    {<span class="dv">37</span>, <span class="dv">39</span>},</a>
<a class="sourceLine" id="cb2-238" title="238">    {<span class="dv">37</span>, <span class="dv">53</span>},</a>
<a class="sourceLine" id="cb2-239" title="239">    {<span class="dv">38</span>, <span class="dv">54</span>},</a>
<a class="sourceLine" id="cb2-240" title="240">    {<span class="dv">39</span>, <span class="dv">55</span>},</a>
<a class="sourceLine" id="cb2-241" title="241">    {<span class="dv">40</span>, <span class="dv">42</span>},</a>
<a class="sourceLine" id="cb2-242" title="242">    {<span class="dv">40</span>, <span class="dv">56</span>},</a>
<a class="sourceLine" id="cb2-243" title="243">    {<span class="dv">41</span>, <span class="dv">43</span>},</a>
<a class="sourceLine" id="cb2-244" title="244">    {<span class="dv">41</span>, <span class="dv">57</span>},</a>
<a class="sourceLine" id="cb2-245" title="245">    {<span class="dv">42</span>, <span class="dv">58</span>},</a>
<a class="sourceLine" id="cb2-246" title="246">    {<span class="dv">43</span>, <span class="dv">59</span>},</a>
<a class="sourceLine" id="cb2-247" title="247">    {<span class="dv">44</span>, <span class="dv">46</span>},</a>
<a class="sourceLine" id="cb2-248" title="248">    {<span class="dv">44</span>, <span class="dv">60</span>},</a>
<a class="sourceLine" id="cb2-249" title="249">    {<span class="dv">45</span>, <span class="dv">47</span>},</a>
<a class="sourceLine" id="cb2-250" title="250">    {<span class="dv">45</span>, <span class="dv">61</span>},</a>
<a class="sourceLine" id="cb2-251" title="251">    {<span class="dv">46</span>, <span class="dv">62</span>},</a>
<a class="sourceLine" id="cb2-252" title="252">    {<span class="dv">47</span>, <span class="dv">63</span>},</a>
<a class="sourceLine" id="cb2-253" title="253">    {<span class="dv">48</span>, <span class="dv">49</span>},</a>
<a class="sourceLine" id="cb2-254" title="254">    {<span class="dv">50</span>, <span class="dv">51</span>},</a>
<a class="sourceLine" id="cb2-255" title="255">    {<span class="dv">52</span>, <span class="dv">53</span>},</a>
<a class="sourceLine" id="cb2-256" title="256">    {<span class="dv">54</span>, <span class="dv">55</span>},</a>
<a class="sourceLine" id="cb2-257" title="257">    {<span class="dv">56</span>, <span class="dv">57</span>},</a>
<a class="sourceLine" id="cb2-258" title="258">    {<span class="dv">58</span>, <span class="dv">59</span>},</a>
<a class="sourceLine" id="cb2-259" title="259">    {<span class="dv">60</span>, <span class="dv">61</span>},</a>
<a class="sourceLine" id="cb2-260" title="260">    {<span class="dv">62</span>, <span class="dv">63</span>} };</a>
<a class="sourceLine" id="cb2-261" title="261"></a>
<a class="sourceLine" id="cb2-262" title="262"><span class="co">// tetrahedra ------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-263" title="263"><span class="dt">int</span>[][] tetrahedra = {</a>
<a class="sourceLine" id="cb2-264" title="264">    {<span class="dv">0</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">48</span>},</a>
<a class="sourceLine" id="cb2-265" title="265">    {<span class="dv">11</span>, <span class="dv">27</span>, <span class="dv">43</span>, <span class="dv">59</span>},</a>
<a class="sourceLine" id="cb2-266" title="266">    {<span class="dv">12</span>, <span class="dv">28</span>, <span class="dv">44</span>, <span class="dv">60</span>},</a>
<a class="sourceLine" id="cb2-267" title="267">    {<span class="dv">8</span>, <span class="dv">24</span>, <span class="dv">40</span>, <span class="dv">56</span>},</a>
<a class="sourceLine" id="cb2-268" title="268">    {<span class="dv">9</span>, <span class="dv">25</span>, <span class="dv">41</span>, <span class="dv">57</span>},</a>
<a class="sourceLine" id="cb2-269" title="269">    {<span class="dv">15</span>, <span class="dv">31</span>, <span class="dv">47</span>, <span class="dv">63</span>},</a>
<a class="sourceLine" id="cb2-270" title="270">    {<span class="dv">13</span>, <span class="dv">29</span>, <span class="dv">45</span>, <span class="dv">61</span>},</a>
<a class="sourceLine" id="cb2-271" title="271">    {<span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">46</span>, <span class="dv">62</span>},</a>
<a class="sourceLine" id="cb2-272" title="272">    {<span class="dv">10</span>, <span class="dv">26</span>, <span class="dv">42</span>, <span class="dv">58</span>},</a>
<a class="sourceLine" id="cb2-273" title="273">    {<span class="dv">3</span>, <span class="dv">19</span>, <span class="dv">35</span>, <span class="dv">51</span>},</a>
<a class="sourceLine" id="cb2-274" title="274">    {<span class="dv">2</span>, <span class="dv">18</span>, <span class="dv">34</span>, <span class="dv">50</span>},</a>
<a class="sourceLine" id="cb2-275" title="275">    {<span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">33</span>, <span class="dv">49</span>},</a>
<a class="sourceLine" id="cb2-276" title="276">    {<span class="dv">4</span>, <span class="dv">20</span>, <span class="dv">36</span>, <span class="dv">52</span>},</a>
<a class="sourceLine" id="cb2-277" title="277">    {<span class="dv">5</span>, <span class="dv">21</span>, <span class="dv">37</span>, <span class="dv">53</span>},</a>
<a class="sourceLine" id="cb2-278" title="278">    {<span class="dv">6</span>, <span class="dv">22</span>, <span class="dv">38</span>, <span class="dv">54</span>},</a>
<a class="sourceLine" id="cb2-279" title="279">    {<span class="dv">7</span>, <span class="dv">23</span>, <span class="dv">39</span>, <span class="dv">55</span>} };</a>
<a class="sourceLine" id="cb2-280" title="280"></a>
<a class="sourceLine" id="cb2-281" title="281"><span class="co">// rotation in 4D space (right-isoclinic) --------------------------------------</span></a>
<a class="sourceLine" id="cb2-282" title="282">quadruple rotate4d(real alpha, real beta, real xi, quadruple vec){</a>
<a class="sourceLine" id="cb2-283" title="283">    real a = cos(xi);</a>
<a class="sourceLine" id="cb2-284" title="284">    real b = sin(alpha)*cos(beta)*sin(xi);</a>
<a class="sourceLine" id="cb2-285" title="285">    real c = sin(alpha)*sin(beta)*sin(xi);</a>
<a class="sourceLine" id="cb2-286" title="286">    real d = cos(alpha)*sin(xi);</a>
<a class="sourceLine" id="cb2-287" title="287">    real p = vec.x;</a>
<a class="sourceLine" id="cb2-288" title="288">    real q = vec.y;</a>
<a class="sourceLine" id="cb2-289" title="289">    real r = vec.z;</a>
<a class="sourceLine" id="cb2-290" title="290">    real s = vec.t;</a>
<a class="sourceLine" id="cb2-291" title="291">    quadruple out;</a>
<a class="sourceLine" id="cb2-292" title="292">    out.x = a*p - b*q - c*r - d*s;</a>
<a class="sourceLine" id="cb2-293" title="293">    out.y = a*q + b*p + c*s - d*r;</a>
<a class="sourceLine" id="cb2-294" title="294">    out.z = a*r - b*s + c*p + d*q;</a>
<a class="sourceLine" id="cb2-295" title="295">    out.t = a*s + b*r - c*q + d*p;</a>
<a class="sourceLine" id="cb2-296" title="296">    <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb2-297" title="297">}</a>
<a class="sourceLine" id="cb2-298" title="298"></a>
<a class="sourceLine" id="cb2-299" title="299"></a>
<a class="sourceLine" id="cb2-300" title="300"><span class="co">// stereographic projection ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-301" title="301">triple stereog(quadruple A, real r){</a>
<a class="sourceLine" id="cb2-302" title="302">    <span class="cf">return</span> (A.x, A.y, A.z) / (r - A.t);</a>
<a class="sourceLine" id="cb2-303" title="303">}</a>
<a class="sourceLine" id="cb2-304" title="304"></a>
<a class="sourceLine" id="cb2-305" title="305"><span class="co">// stereographic path ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-306" title="306">path3 stereoPath(quadruple A, quadruple B, real r, <span class="dt">int</span> n){</a>
<a class="sourceLine" id="cb2-307" title="307">    path3 out;</a>
<a class="sourceLine" id="cb2-308" title="308">    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt;= n; ++i){</a>
<a class="sourceLine" id="cb2-309" title="309">        real t = i/n;</a>
<a class="sourceLine" id="cb2-310" title="310">        quadruple M;</a>
<a class="sourceLine" id="cb2-311" title="311">        real x = (<span class="dv">1</span>-t)*A.x + t*B.x;</a>
<a class="sourceLine" id="cb2-312" title="312">        real y = (<span class="dv">1</span>-t)*A.y + t*B.y;</a>
<a class="sourceLine" id="cb2-313" title="313">        real z = (<span class="dv">1</span>-t)*A.z + t*B.z;</a>
<a class="sourceLine" id="cb2-314" title="314">        real t = (<span class="dv">1</span>-t)*A.t + t*B.t;</a>
<a class="sourceLine" id="cb2-315" title="315">        real lg = sqrt(x*x + y*y + z*z + t*t) / r;</a>
<a class="sourceLine" id="cb2-316" title="316">        M.x = x / lg; M.y = y / lg; M.z = z / lg; M.t = t / lg;</a>
<a class="sourceLine" id="cb2-317" title="317">        out = out .. stereog(M, r);</a>
<a class="sourceLine" id="cb2-318" title="318">    }</a>
<a class="sourceLine" id="cb2-319" title="319">    <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb2-320" title="320">}</a>
<a class="sourceLine" id="cb2-321" title="321"></a>
<a class="sourceLine" id="cb2-322" title="322"><span class="co">// section transformation ------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-323" title="323">transform T(path3 p3, real t, <span class="dt">int</span> n){</a>
<a class="sourceLine" id="cb2-324" title="324">    triple M = relpoint(p3, t/(n/<span class="dv">4</span>));</a>
<a class="sourceLine" id="cb2-325" title="325">    <span class="cf">return</span> scale(length(M)/<span class="dv">15</span>); </a>
<a class="sourceLine" id="cb2-326" title="326">}</a>
<a class="sourceLine" id="cb2-327" title="327"></a>
<a class="sourceLine" id="cb2-328" title="328"><span class="co">// stereographic subdivision (to fill the tetrahedra) --------------------------</span></a>
<a class="sourceLine" id="cb2-329" title="329">quadruple midpoint4(quadruple A, quadruple B, real r){</a>
<a class="sourceLine" id="cb2-330" title="330">    quadruple M;</a>
<a class="sourceLine" id="cb2-331" title="331">    real x = (A.x + B.x)/<span class="dv">2</span>;</a>
<a class="sourceLine" id="cb2-332" title="332">    real y = (A.y + B.y)/<span class="dv">2</span>;</a>
<a class="sourceLine" id="cb2-333" title="333">    real z = (A.z + B.z)/<span class="dv">2</span>;</a>
<a class="sourceLine" id="cb2-334" title="334">    real t = (A.t + B.t)/<span class="dv">2</span>;</a>
<a class="sourceLine" id="cb2-335" title="335">    real lg = sqrt(x*x + y*y + z*z + t*t) / r;</a>
<a class="sourceLine" id="cb2-336" title="336">    M.x = x / lg; M.y = y / lg; M.z = z / lg; M.t = t / lg;</a>
<a class="sourceLine" id="cb2-337" title="337">    <span class="cf">return</span>(M);</a>
<a class="sourceLine" id="cb2-338" title="338">} </a>
<a class="sourceLine" id="cb2-339" title="339"></a>
<a class="sourceLine" id="cb2-340" title="340">quadruple[][] subdiv0(quadruple A, quadruple B, quadruple C, real r){</a>
<a class="sourceLine" id="cb2-341" title="341">    quadruple m01 = midpoint4(A, B, r);</a>
<a class="sourceLine" id="cb2-342" title="342">    quadruple m02 = midpoint4(A, C, r);</a>
<a class="sourceLine" id="cb2-343" title="343">    quadruple m12 = midpoint4(B, C, r);</a>
<a class="sourceLine" id="cb2-344" title="344">    <span class="cf">return</span> <span class="kw">new</span> quadruple[][] {</a>
<a class="sourceLine" id="cb2-345" title="345">        {A, m01, m02}, </a>
<a class="sourceLine" id="cb2-346" title="346">        {B, m12, m01}, </a>
<a class="sourceLine" id="cb2-347" title="347">        {C, m02, m12}, </a>
<a class="sourceLine" id="cb2-348" title="348">        {m01, m12, m02}</a>
<a class="sourceLine" id="cb2-349" title="349">    };</a>
<a class="sourceLine" id="cb2-350" title="350">}</a>
<a class="sourceLine" id="cb2-351" title="351"></a>
<a class="sourceLine" id="cb2-352" title="352">quadruple[][] subdiv(<span class="dt">int</span> n, quadruple A, quadruple B, quadruple C, real r){</a>
<a class="sourceLine" id="cb2-353" title="353">  <span class="cf">if</span>(n == <span class="dv">1</span>){</a>
<a class="sourceLine" id="cb2-354" title="354">    <span class="cf">return</span> subdiv0(A, B, C, r);</a>
<a class="sourceLine" id="cb2-355" title="355">  }</a>
<a class="sourceLine" id="cb2-356" title="356">  quadruple[][] triangles = subdiv(n-<span class="dv">1</span>, A, B, C, r);</a>
<a class="sourceLine" id="cb2-357" title="357">  quadruple[][] out = <span class="kw">new</span> quadruple[<span class="dv">0</span>][<span class="dv">3</span>];</a>
<a class="sourceLine" id="cb2-358" title="358">  <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">4</span>^(n-<span class="dv">1</span>); ++i){</a>
<a class="sourceLine" id="cb2-359" title="359">    quadruple[] trgl = triangles[i];</a>
<a class="sourceLine" id="cb2-360" title="360">    out.append(subdiv0(trgl[<span class="dv">0</span>], trgl[<span class="dv">1</span>], trgl[<span class="dv">2</span>], r));</a>
<a class="sourceLine" id="cb2-361" title="361">  }</a>
<a class="sourceLine" id="cb2-362" title="362">  <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb2-363" title="363">}</a>
<a class="sourceLine" id="cb2-364" title="364"></a>
<a class="sourceLine" id="cb2-365" title="365"><span class="co">// mesh maker ------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-366" title="366"><span class="kw">struct</span> Mesh {</a>
<a class="sourceLine" id="cb2-367" title="367">    triple[] vertices;</a>
<a class="sourceLine" id="cb2-368" title="368">    <span class="dt">int</span>[][] indices;</a>
<a class="sourceLine" id="cb2-369" title="369">}</a>
<a class="sourceLine" id="cb2-370" title="370">Mesh stereoTriangle(<span class="dt">int</span> n, quadruple A, quadruple B, quadruple C, real r){</a>
<a class="sourceLine" id="cb2-371" title="371">    quadruple[][] triangles = subdiv(n, A, B, C, r);</a>
<a class="sourceLine" id="cb2-372" title="372">    triple[] vertices;</a>
<a class="sourceLine" id="cb2-373" title="373">    <span class="dt">int</span>[][] indices;</a>
<a class="sourceLine" id="cb2-374" title="374">    <span class="dt">int</span> faceIndex = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb2-375" title="375">    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; triangles.length; ++i){</a>
<a class="sourceLine" id="cb2-376" title="376">        quadruple[] triangle = triangles[i];</a>
<a class="sourceLine" id="cb2-377" title="377">        vertices.push(stereog(triangle[<span class="dv">0</span>], r));</a>
<a class="sourceLine" id="cb2-378" title="378">        vertices.push(stereog(triangle[<span class="dv">1</span>], r));</a>
<a class="sourceLine" id="cb2-379" title="379">        vertices.push(stereog(triangle[<span class="dv">2</span>], r));</a>
<a class="sourceLine" id="cb2-380" title="380">        <span class="dt">int</span>[] x = {faceIndex, faceIndex+<span class="dv">1</span>, faceIndex+<span class="dv">2</span>};</a>
<a class="sourceLine" id="cb2-381" title="381">        indices.push(x);</a>
<a class="sourceLine" id="cb2-382" title="382">        faceIndex += <span class="dv">3</span>;</a>
<a class="sourceLine" id="cb2-383" title="383">    }</a>
<a class="sourceLine" id="cb2-384" title="384">    Mesh out;</a>
<a class="sourceLine" id="cb2-385" title="385">    out.vertices = vertices;</a>
<a class="sourceLine" id="cb2-386" title="386">    out.indices = indices;</a>
<a class="sourceLine" id="cb2-387" title="387">    <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb2-388" title="388">}</a>
<a class="sourceLine" id="cb2-389" title="389"></a>
<a class="sourceLine" id="cb2-390" title="390"></a>
<a class="sourceLine" id="cb2-391" title="391"><span class="co">// &quot;bounding box&quot; (to clip the animation) --------------------------------------</span></a>
<a class="sourceLine" id="cb2-392" title="392">path3 boundingbox = scale(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">1</span>)*circle(c=O, r=<span class="dv">4</span>, normal=Z);</a>
<a class="sourceLine" id="cb2-393" title="393"></a>
<a class="sourceLine" id="cb2-394" title="394"><span class="co">// plot ------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-395" title="395"><span class="dt">int</span> n = <span class="dv">75</span>;</a>
<a class="sourceLine" id="cb2-396" title="396"><span class="dt">int</span> depth = <span class="dv">6</span>;</a>
<a class="sourceLine" id="cb2-397" title="397">real alpha = <span class="dv">0</span>, beta = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb2-398" title="398"></a>
<a class="sourceLine" id="cb2-399" title="399"><span class="cf">for</span>(<span class="dt">int</span> f = <span class="dv">0</span>; f &lt; <span class="dv">180</span>; ++f){</a>
<a class="sourceLine" id="cb2-400" title="400">    <span class="co">// rotation angle</span></a>
<a class="sourceLine" id="cb2-401" title="401">    real xi = <span class="dv">2</span>*f*pi/<span class="dv">180</span>;</a>
<a class="sourceLine" id="cb2-402" title="402">    <span class="co">// rotated vertices</span></a>
<a class="sourceLine" id="cb2-403" title="403">    quadruple[] vs = <span class="kw">new</span> quadruple[vertices.length];</a>
<a class="sourceLine" id="cb2-404" title="404">    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; vertices.length; ++i){</a>
<a class="sourceLine" id="cb2-405" title="405">        vs[i] = rotate4d(alpha, beta, xi, vertices[i]);</a>
<a class="sourceLine" id="cb2-406" title="406">    }</a>
<a class="sourceLine" id="cb2-407" title="407">    <span class="co">// new picture</span></a>
<a class="sourceLine" id="cb2-408" title="408">    picture pic;</a>
<a class="sourceLine" id="cb2-409" title="409">    <span class="co">// draw boundingbox</span></a>
<a class="sourceLine" id="cb2-410" title="410">    draw(pic, boundingbox, rgb(<span class="st">&quot;363940ff&quot;</span>)+opacity(<span class="dv">0</span>));</a>
<a class="sourceLine" id="cb2-411" title="411">    <span class="co">// draw edges</span></a>
<a class="sourceLine" id="cb2-412" title="412">    <span class="cf">for</span>(<span class="dt">int</span> k = <span class="dv">0</span>; k &lt; edges.length; ++k){</a>
<a class="sourceLine" id="cb2-413" title="413">        quadruple A = vs[edges[k][<span class="dv">0</span>]];</a>
<a class="sourceLine" id="cb2-414" title="414">        quadruple B = vs[edges[k][<span class="dv">1</span>]];</a>
<a class="sourceLine" id="cb2-415" title="415">        path3 p3 = stereoPath(A, B, r, n);</a>
<a class="sourceLine" id="cb2-416" title="416">        transform S(real t){</a>
<a class="sourceLine" id="cb2-417" title="417">            <span class="cf">return</span> T(p3, t, n);</a>
<a class="sourceLine" id="cb2-418" title="418">        }</a>
<a class="sourceLine" id="cb2-419" title="419">        draw(pic, tube(p3, unitcircle, S), rgb(<span class="dv">139</span>, <span class="dv">0</span>, <span class="dv">139</span>), </a>
<a class="sourceLine" id="cb2-420" title="420">                render(compression=Low, merge=<span class="kw">true</span>));</a>
<a class="sourceLine" id="cb2-421" title="421">    }</a>
<a class="sourceLine" id="cb2-422" title="422">    <span class="co">// draw vertices</span></a>
<a class="sourceLine" id="cb2-423" title="423">    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; vertices.length; ++i){</a>
<a class="sourceLine" id="cb2-424" title="424">        triple Asg = stereog(vs[i], r);</a>
<a class="sourceLine" id="cb2-425" title="425">        draw(pic, shift(Asg)*scale3(length(Asg)/<span class="dv">10</span>)*unitsphere, purple);</a>
<a class="sourceLine" id="cb2-426" title="426">    }</a>
<a class="sourceLine" id="cb2-427" title="427">    <span class="co">// draw tetrahedra</span></a>
<a class="sourceLine" id="cb2-428" title="428">    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; tetrahedra.length; ++i){</a>
<a class="sourceLine" id="cb2-429" title="429">        <span class="dt">int</span>[] t = tetrahedra[i];</a>
<a class="sourceLine" id="cb2-430" title="430">        Mesh mesh = stereoTriangle(depth, vs[t[<span class="dv">0</span>]], vs[t[<span class="dv">1</span>]], vs[t[<span class="dv">2</span>]], r);</a>
<a class="sourceLine" id="cb2-431" title="431">        draw(pic, mesh.vertices, mesh.indices, m = red);</a>
<a class="sourceLine" id="cb2-432" title="432">        Mesh mesh = stereoTriangle(depth, vs[t[<span class="dv">0</span>]], vs[t[<span class="dv">1</span>]], vs[t[<span class="dv">3</span>]], r);</a>
<a class="sourceLine" id="cb2-433" title="433">        draw(pic, mesh.vertices, mesh.indices, m = red);</a>
<a class="sourceLine" id="cb2-434" title="434">        Mesh mesh = stereoTriangle(depth, vs[t[<span class="dv">0</span>]], vs[t[<span class="dv">2</span>]], vs[t[<span class="dv">3</span>]], r);</a>
<a class="sourceLine" id="cb2-435" title="435">        draw(pic, mesh.vertices, mesh.indices, m = red);</a>
<a class="sourceLine" id="cb2-436" title="436">        Mesh mesh = stereoTriangle(depth, vs[t[<span class="dv">1</span>]], vs[t[<span class="dv">2</span>]], vs[t[<span class="dv">3</span>]], r);</a>
<a class="sourceLine" id="cb2-437" title="437">        draw(pic, mesh.vertices, mesh.indices, m = red);</a>
<a class="sourceLine" id="cb2-438" title="438">    }</a>
<a class="sourceLine" id="cb2-439" title="439">    <span class="co">// add picture and save</span></a>
<a class="sourceLine" id="cb2-440" title="440">    add(pic);</a>
<a class="sourceLine" id="cb2-441" title="441">    shipout(files[f], bbox(rgb(<span class="st">&quot;363940ff&quot;</span>), FillDraw(rgb(<span class="st">&quot;363940ff&quot;</span>))));</a>
<a class="sourceLine" id="cb2-442" title="442">    erase();</a>
<a class="sourceLine" id="cb2-443" title="443">}   </a></code></pre></div>
<p><img src="figures/truncatedTesseract_stereographic_asy.gif" /></p>
<h1 id="drawing-with-pov-ray">Drawing with POV-Ray</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode povray"><code class="sourceCode povray"><a class="sourceLine" id="cb3-1" title="1"><span class="ot">#version</span> <span class="fl">3.7</span>;</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">global_settings</span> { <span class="kw">assumed_gamma</span> <span class="fl">1</span> }</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="ot">#include</span> <span class="st">&quot;colors.inc&quot;</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="ot">#include</span> <span class="st">&quot;textures.inc&quot;</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">/* camera */</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">camera</span> {</a>
<a class="sourceLine" id="cb3-8" title="8">    <span class="kw">location</span> &lt;-<span class="fl">11</span>, <span class="fl">7</span>,-<span class="fl">32</span>&gt;</a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="kw">look_at</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb3-10" title="10">    <span class="kw">angle</span> <span class="fl">45</span></a>
<a class="sourceLine" id="cb3-11" title="11">}</a>
<a class="sourceLine" id="cb3-12" title="12"></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">// sun -------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="kw">light_source</span> {&lt; <span class="fl">1000</span>,<span class="fl">3000</span>,-<span class="fl">6000</span>&gt; <span class="kw">color</span> <span class="kw">rgb</span>&lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;*<span class="fl">0.9</span>}             <span class="co">// sun </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="kw">light_source</span> {&lt;-<span class="fl">11</span>, <span class="fl">7</span>,-<span class="fl">32</span>&gt;  <span class="kw">color</span> <span class="kw">rgb</span>&lt;<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">1</span>&gt;*<span class="fl">0.1</span> <span class="kw">shadowless</span>}   <span class="co">// flash</span></a>
<a class="sourceLine" id="cb3-16" title="16"></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">// sky -------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="kw">plane</span>{&lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;,<span class="fl">1</span> <span class="kw">hollow</span>  </a>
<a class="sourceLine" id="cb3-19" title="19">       <span class="kw">texture</span>{ <span class="kw">pigment</span>{ <span class="kw">bozo</span> <span class="kw">turbulence</span> <span class="fl">1.3</span></a>
<a class="sourceLine" id="cb3-20" title="20">                         <span class="kw">color_map</span> { [<span class="fl">0.00</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</a>
<a class="sourceLine" id="cb3-21" title="21">                                     [<span class="fl">0.75</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</a>
<a class="sourceLine" id="cb3-22" title="22">                                     [<span class="fl">0.83</span> <span class="kw">rgb</span> &lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;]</a>
<a class="sourceLine" id="cb3-23" title="23">                                     [<span class="fl">0.95</span> <span class="kw">rgb</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;]</a>
<a class="sourceLine" id="cb3-24" title="24">                                     [<span class="fl">1.0</span> <span class="kw">rgb</span> &lt;<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>&gt;]}</a>
<a class="sourceLine" id="cb3-25" title="25">                        <span class="kw">scale</span>&lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;*<span class="fl">2.5</span>  <span class="kw">translate</span>&lt; <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">3</span>&gt;</a>
<a class="sourceLine" id="cb3-26" title="26">                       }</a>
<a class="sourceLine" id="cb3-27" title="27">                <span class="kw">finish</span> {<span class="kw">ambient</span> <span class="fl">1</span> <span class="kw">diffuse</span> <span class="fl">0</span>} }      </a>
<a class="sourceLine" id="cb3-28" title="28">       <span class="kw">scale</span> <span class="fl">10000</span>}</a>
<a class="sourceLine" id="cb3-29" title="29"></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">// fog on the ground -----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="kw">fog</span> { <span class="kw">fog_type</span>   <span class="fl">2</span></a>
<a class="sourceLine" id="cb3-32" title="32">      <span class="kw">distance</span>   <span class="fl">50</span></a>
<a class="sourceLine" id="cb3-33" title="33">      <span class="kw">color</span>      Gray10  </a>
<a class="sourceLine" id="cb3-34" title="34">      <span class="kw">fog_offset</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb3-35" title="35">      <span class="kw">fog_alt</span>    <span class="fl">1.5</span></a>
<a class="sourceLine" id="cb3-36" title="36">      <span class="kw">turbulence</span> <span class="fl">1.8</span></a>
<a class="sourceLine" id="cb3-37" title="37">    }</a>
<a class="sourceLine" id="cb3-38" title="38"></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">// ground ----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="kw">plane</span> { &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">0</span> </a>
<a class="sourceLine" id="cb3-41" title="41">    <span class="kw">texture</span> {</a>
<a class="sourceLine" id="cb3-42" title="42">        <span class="kw">pigment</span> { <span class="kw">color</span> <span class="kw">rgb</span> &lt;<span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.73</span>&gt;*<span class="fl">0.35</span> }</a>
<a class="sourceLine" id="cb3-43" title="43">        <span class="kw">normal</span> { <span class="kw">bumps</span> <span class="fl">2</span> <span class="kw">scale</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;*<span class="fl">0.5</span> <span class="kw">turbulence</span> <span class="fl">0.5</span> } </a>
<a class="sourceLine" id="cb3-44" title="44">        <span class="kw">finish</span> { <span class="kw">phong</span> <span class="fl">0.1</span> }</a>
<a class="sourceLine" id="cb3-45" title="45">    } </a>
<a class="sourceLine" id="cb3-46" title="46">} </a>
<a class="sourceLine" id="cb3-47" title="47"></a>
<a class="sourceLine" id="cb3-48" title="48"></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="co">/* vertices */</span></a>
<a class="sourceLine" id="cb3-50" title="50"><span class="kw">#declare sqr2p1 </span>= <span class="kw">sqrt</span>(<span class="fl">2</span>) + <span class="fl">1</span>;</a>
<a class="sourceLine" id="cb3-51" title="51"><span class="kw">#declare v0 </span>= &lt; <span class="fl">-1.0</span> , -sqr2p1 , -sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-52" title="52"><span class="kw">#declare v1 </span>= &lt; <span class="fl">-1.0</span> , -sqr2p1 , -sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-53" title="53"><span class="kw">#declare v2 </span>= &lt; <span class="fl">-1.0</span> , -sqr2p1 , sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-54" title="54"><span class="kw">#declare v3 </span>= &lt; <span class="fl">-1.0</span> , -sqr2p1 , sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-55" title="55"><span class="kw">#declare v4 </span>= &lt; <span class="fl">-1.0</span> , sqr2p1 , -sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-56" title="56"><span class="kw">#declare v5 </span>= &lt; <span class="fl">-1.0</span> , sqr2p1 , -sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-57" title="57"><span class="kw">#declare v6 </span>= &lt; <span class="fl">-1.0</span> , sqr2p1 , sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-58" title="58"><span class="kw">#declare v7 </span>= &lt; <span class="fl">-1.0</span> , sqr2p1 , sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-59" title="59"><span class="kw">#declare v8 </span>= &lt; <span class="fl">1.0</span> , -sqr2p1 , -sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-60" title="60"><span class="kw">#declare v9 </span>= &lt; <span class="fl">1.0</span> , -sqr2p1 , -sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-61" title="61"><span class="kw">#declare v10 </span>= &lt; <span class="fl">1.0</span> , -sqr2p1 , sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-62" title="62"><span class="kw">#declare v11 </span>= &lt; <span class="fl">1.0</span> , -sqr2p1 , sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-63" title="63"><span class="kw">#declare v12 </span>= &lt; <span class="fl">1.0</span> , sqr2p1 , -sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-64" title="64"><span class="kw">#declare v13 </span>= &lt; <span class="fl">1.0</span> , sqr2p1 , -sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-65" title="65"><span class="kw">#declare v14 </span>= &lt; <span class="fl">1.0</span> , sqr2p1 , sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-66" title="66"><span class="kw">#declare v15 </span>= &lt; <span class="fl">1.0</span> , sqr2p1 , sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-67" title="67"><span class="kw">#declare v16 </span>= &lt; -sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-68" title="68"><span class="kw">#declare v17 </span>= &lt; -sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-69" title="69"><span class="kw">#declare v18 </span>= &lt; -sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-70" title="70"><span class="kw">#declare v19 </span>= &lt; -sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-71" title="71"><span class="kw">#declare v20 </span>= &lt; -sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-72" title="72"><span class="kw">#declare v21 </span>= &lt; -sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-73" title="73"><span class="kw">#declare v22 </span>= &lt; -sqr2p1 , <span class="fl">1.0</span> , sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-74" title="74"><span class="kw">#declare v23 </span>= &lt; -sqr2p1 , <span class="fl">1.0</span> , sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-75" title="75"><span class="kw">#declare v24 </span>= &lt; sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-76" title="76"><span class="kw">#declare v25 </span>= &lt; sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-77" title="77"><span class="kw">#declare v26 </span>= &lt; sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-78" title="78"><span class="kw">#declare v27 </span>= &lt; sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-79" title="79"><span class="kw">#declare v28 </span>= &lt; sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-80" title="80"><span class="kw">#declare v29 </span>= &lt; sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-81" title="81"><span class="kw">#declare v30 </span>= &lt; sqr2p1 , <span class="fl">1.0</span> , sqr2p1 , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-82" title="82"><span class="kw">#declare v31 </span>= &lt; sqr2p1 , <span class="fl">1.0</span> , sqr2p1 , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-83" title="83"><span class="kw">#declare v32 </span>= &lt; -sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-84" title="84"><span class="kw">#declare v33 </span>= &lt; -sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-85" title="85"><span class="kw">#declare v34 </span>= &lt; -sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-86" title="86"><span class="kw">#declare v35 </span>= &lt; -sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-87" title="87"><span class="kw">#declare v36 </span>= &lt; -sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-88" title="88"><span class="kw">#declare v37 </span>= &lt; -sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-89" title="89"><span class="kw">#declare v38 </span>= &lt; -sqr2p1 , sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-90" title="90"><span class="kw">#declare v39 </span>= &lt; -sqr2p1 , sqr2p1 , <span class="fl">1.0</span> , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-91" title="91"><span class="kw">#declare v40 </span>= &lt; sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-92" title="92"><span class="kw">#declare v41 </span>= &lt; sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-93" title="93"><span class="kw">#declare v42 </span>= &lt; sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-94" title="94"><span class="kw">#declare v43 </span>= &lt; sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-95" title="95"><span class="kw">#declare v44 </span>= &lt; sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-96" title="96"><span class="kw">#declare v45 </span>= &lt; sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-97" title="97"><span class="kw">#declare v46 </span>= &lt; sqr2p1 , sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-98" title="98"><span class="kw">#declare v47 </span>= &lt; sqr2p1 , sqr2p1 , <span class="fl">1.0</span> , sqr2p1 &gt;;</a>
<a class="sourceLine" id="cb3-99" title="99"><span class="kw">#declare v48 </span>= &lt; -sqr2p1 , -sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-100" title="100"><span class="kw">#declare v49 </span>= &lt; -sqr2p1 , -sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-101" title="101"><span class="kw">#declare v50 </span>= &lt; -sqr2p1 , -sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-102" title="102"><span class="kw">#declare v51 </span>= &lt; -sqr2p1 , -sqr2p1 , sqr2p1 , <span class="fl">1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-103" title="103"><span class="kw">#declare v52 </span>= &lt; -sqr2p1 , sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-104" title="104"><span class="kw">#declare v53 </span>= &lt; -sqr2p1 , sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-105" title="105"><span class="kw">#declare v54 </span>= &lt; -sqr2p1 , sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-106" title="106"><span class="kw">#declare v55 </span>= &lt; -sqr2p1 , sqr2p1 , sqr2p1 , <span class="fl">1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-107" title="107"><span class="kw">#declare v56 </span>= &lt; sqr2p1 , -sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-108" title="108"><span class="kw">#declare v57 </span>= &lt; sqr2p1 , -sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-109" title="109"><span class="kw">#declare v58 </span>= &lt; sqr2p1 , -sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-110" title="110"><span class="kw">#declare v59 </span>= &lt; sqr2p1 , -sqr2p1 , sqr2p1 , <span class="fl">1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-111" title="111"><span class="kw">#declare v60 </span>= &lt; sqr2p1 , sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-112" title="112"><span class="kw">#declare v61 </span>= &lt; sqr2p1 , sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-113" title="113"><span class="kw">#declare v62 </span>= &lt; sqr2p1 , sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-114" title="114"><span class="kw">#declare v63 </span>= &lt; sqr2p1 , sqr2p1 , sqr2p1 , <span class="fl">1.0</span> &gt;;</a>
<a class="sourceLine" id="cb3-115" title="115"><span class="kw">#declare vertices </span>= <span class="kw">array</span>[<span class="fl">64</span>] </a>
<a class="sourceLine" id="cb3-116" title="116">    {v0,v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,</a>
<a class="sourceLine" id="cb3-117" title="117">    v16,v17,v18,v19,v20,v21,v22,v23,v24,v25,v26,v27,v28,v29,v30,v31,</a>
<a class="sourceLine" id="cb3-118" title="118">    v32,v33,v34,v35,v36,v37,v38,v39,v40,v41,v42,v43,v44,v45,v46,v47,</a>
<a class="sourceLine" id="cb3-119" title="119">    v48,v49,v50,v51,v52,v53,v54,v55,v56,v57,v58,v59,v60,v61,v62,v63};</a>
<a class="sourceLine" id="cb3-120" title="120"></a>
<a class="sourceLine" id="cb3-121" title="121"><span class="co">/* edges */</span></a>
<a class="sourceLine" id="cb3-122" title="122"><span class="kw">#declare edges </span>= <span class="kw">array</span>[<span class="fl">128</span>][<span class="fl">2</span>] </a>
<a class="sourceLine" id="cb3-123" title="123">{ { <span class="fl">0</span> , <span class="fl">8</span> }</a>
<a class="sourceLine" id="cb3-124" title="124">, { <span class="fl">0</span> , <span class="fl">16</span> }</a>
<a class="sourceLine" id="cb3-125" title="125">, { <span class="fl">0</span> , <span class="fl">32</span> }</a>
<a class="sourceLine" id="cb3-126" title="126">, { <span class="fl">0</span> , <span class="fl">48</span> }</a>
<a class="sourceLine" id="cb3-127" title="127">, { <span class="fl">1</span> , <span class="fl">9</span> }</a>
<a class="sourceLine" id="cb3-128" title="128">, { <span class="fl">1</span> , <span class="fl">17</span> }</a>
<a class="sourceLine" id="cb3-129" title="129">, { <span class="fl">1</span> , <span class="fl">33</span> }</a>
<a class="sourceLine" id="cb3-130" title="130">, { <span class="fl">1</span> , <span class="fl">49</span> }</a>
<a class="sourceLine" id="cb3-131" title="131">, { <span class="fl">2</span> , <span class="fl">10</span> }</a>
<a class="sourceLine" id="cb3-132" title="132">, { <span class="fl">2</span> , <span class="fl">18</span> }</a>
<a class="sourceLine" id="cb3-133" title="133">, { <span class="fl">2</span> , <span class="fl">34</span> }</a>
<a class="sourceLine" id="cb3-134" title="134">, { <span class="fl">2</span> , <span class="fl">50</span> }</a>
<a class="sourceLine" id="cb3-135" title="135">, { <span class="fl">3</span> , <span class="fl">11</span> }</a>
<a class="sourceLine" id="cb3-136" title="136">, { <span class="fl">3</span> , <span class="fl">19</span> }</a>
<a class="sourceLine" id="cb3-137" title="137">, { <span class="fl">3</span> , <span class="fl">35</span> }</a>
<a class="sourceLine" id="cb3-138" title="138">, { <span class="fl">3</span> , <span class="fl">51</span> }</a>
<a class="sourceLine" id="cb3-139" title="139">, { <span class="fl">4</span> , <span class="fl">12</span> }</a>
<a class="sourceLine" id="cb3-140" title="140">, { <span class="fl">4</span> , <span class="fl">20</span> }</a>
<a class="sourceLine" id="cb3-141" title="141">, { <span class="fl">4</span> , <span class="fl">36</span> }</a>
<a class="sourceLine" id="cb3-142" title="142">, { <span class="fl">4</span> , <span class="fl">52</span> }</a>
<a class="sourceLine" id="cb3-143" title="143">, { <span class="fl">5</span> , <span class="fl">13</span> }</a>
<a class="sourceLine" id="cb3-144" title="144">, { <span class="fl">5</span> , <span class="fl">21</span> }</a>
<a class="sourceLine" id="cb3-145" title="145">, { <span class="fl">5</span> , <span class="fl">37</span> }</a>
<a class="sourceLine" id="cb3-146" title="146">, { <span class="fl">5</span> , <span class="fl">53</span> }</a>
<a class="sourceLine" id="cb3-147" title="147">, { <span class="fl">6</span> , <span class="fl">14</span> }</a>
<a class="sourceLine" id="cb3-148" title="148">, { <span class="fl">6</span> , <span class="fl">22</span> }</a>
<a class="sourceLine" id="cb3-149" title="149">, { <span class="fl">6</span> , <span class="fl">38</span> }</a>
<a class="sourceLine" id="cb3-150" title="150">, { <span class="fl">6</span> , <span class="fl">54</span> }</a>
<a class="sourceLine" id="cb3-151" title="151">, { <span class="fl">7</span> , <span class="fl">15</span> }</a>
<a class="sourceLine" id="cb3-152" title="152">, { <span class="fl">7</span> , <span class="fl">23</span> }</a>
<a class="sourceLine" id="cb3-153" title="153">, { <span class="fl">7</span> , <span class="fl">39</span> }</a>
<a class="sourceLine" id="cb3-154" title="154">, { <span class="fl">7</span> , <span class="fl">55</span> }</a>
<a class="sourceLine" id="cb3-155" title="155">, { <span class="fl">8</span> , <span class="fl">24</span> }</a>
<a class="sourceLine" id="cb3-156" title="156">, { <span class="fl">8</span> , <span class="fl">40</span> }</a>
<a class="sourceLine" id="cb3-157" title="157">, { <span class="fl">8</span> , <span class="fl">56</span> }</a>
<a class="sourceLine" id="cb3-158" title="158">, { <span class="fl">9</span> , <span class="fl">25</span> }</a>
<a class="sourceLine" id="cb3-159" title="159">, { <span class="fl">9</span> , <span class="fl">41</span> }</a>
<a class="sourceLine" id="cb3-160" title="160">, { <span class="fl">9</span> , <span class="fl">57</span> }</a>
<a class="sourceLine" id="cb3-161" title="161">, { <span class="fl">10</span> , <span class="fl">26</span> }</a>
<a class="sourceLine" id="cb3-162" title="162">, { <span class="fl">10</span> , <span class="fl">42</span> }</a>
<a class="sourceLine" id="cb3-163" title="163">, { <span class="fl">10</span> , <span class="fl">58</span> }</a>
<a class="sourceLine" id="cb3-164" title="164">, { <span class="fl">11</span> , <span class="fl">27</span> }</a>
<a class="sourceLine" id="cb3-165" title="165">, { <span class="fl">11</span> , <span class="fl">43</span> }</a>
<a class="sourceLine" id="cb3-166" title="166">, { <span class="fl">11</span> , <span class="fl">59</span> }</a>
<a class="sourceLine" id="cb3-167" title="167">, { <span class="fl">12</span> , <span class="fl">28</span> }</a>
<a class="sourceLine" id="cb3-168" title="168">, { <span class="fl">12</span> , <span class="fl">44</span> }</a>
<a class="sourceLine" id="cb3-169" title="169">, { <span class="fl">12</span> , <span class="fl">60</span> }</a>
<a class="sourceLine" id="cb3-170" title="170">, { <span class="fl">13</span> , <span class="fl">29</span> }</a>
<a class="sourceLine" id="cb3-171" title="171">, { <span class="fl">13</span> , <span class="fl">45</span> }</a>
<a class="sourceLine" id="cb3-172" title="172">, { <span class="fl">13</span> , <span class="fl">61</span> }</a>
<a class="sourceLine" id="cb3-173" title="173">, { <span class="fl">14</span> , <span class="fl">30</span> }</a>
<a class="sourceLine" id="cb3-174" title="174">, { <span class="fl">14</span> , <span class="fl">46</span> }</a>
<a class="sourceLine" id="cb3-175" title="175">, { <span class="fl">14</span> , <span class="fl">62</span> }</a>
<a class="sourceLine" id="cb3-176" title="176">, { <span class="fl">15</span> , <span class="fl">31</span> }</a>
<a class="sourceLine" id="cb3-177" title="177">, { <span class="fl">15</span> , <span class="fl">47</span> }</a>
<a class="sourceLine" id="cb3-178" title="178">, { <span class="fl">15</span> , <span class="fl">63</span> }</a>
<a class="sourceLine" id="cb3-179" title="179">, { <span class="fl">16</span> , <span class="fl">20</span> }</a>
<a class="sourceLine" id="cb3-180" title="180">, { <span class="fl">16</span> , <span class="fl">32</span> }</a>
<a class="sourceLine" id="cb3-181" title="181">, { <span class="fl">16</span> , <span class="fl">48</span> }</a>
<a class="sourceLine" id="cb3-182" title="182">, { <span class="fl">17</span> , <span class="fl">21</span> }</a>
<a class="sourceLine" id="cb3-183" title="183">, { <span class="fl">17</span> , <span class="fl">33</span> }</a>
<a class="sourceLine" id="cb3-184" title="184">, { <span class="fl">17</span> , <span class="fl">49</span> }</a>
<a class="sourceLine" id="cb3-185" title="185">, { <span class="fl">18</span> , <span class="fl">22</span> }</a>
<a class="sourceLine" id="cb3-186" title="186">, { <span class="fl">18</span> , <span class="fl">34</span> }</a>
<a class="sourceLine" id="cb3-187" title="187">, { <span class="fl">18</span> , <span class="fl">50</span> }</a>
<a class="sourceLine" id="cb3-188" title="188">, { <span class="fl">19</span> , <span class="fl">23</span> }</a>
<a class="sourceLine" id="cb3-189" title="189">, { <span class="fl">19</span> , <span class="fl">35</span> }</a>
<a class="sourceLine" id="cb3-190" title="190">, { <span class="fl">19</span> , <span class="fl">51</span> }</a>
<a class="sourceLine" id="cb3-191" title="191">, { <span class="fl">20</span> , <span class="fl">36</span> }</a>
<a class="sourceLine" id="cb3-192" title="192">, { <span class="fl">20</span> , <span class="fl">52</span> }</a>
<a class="sourceLine" id="cb3-193" title="193">, { <span class="fl">21</span> , <span class="fl">37</span> }</a>
<a class="sourceLine" id="cb3-194" title="194">, { <span class="fl">21</span> , <span class="fl">53</span> }</a>
<a class="sourceLine" id="cb3-195" title="195">, { <span class="fl">22</span> , <span class="fl">38</span> }</a>
<a class="sourceLine" id="cb3-196" title="196">, { <span class="fl">22</span> , <span class="fl">54</span> }</a>
<a class="sourceLine" id="cb3-197" title="197">, { <span class="fl">23</span> , <span class="fl">39</span> }</a>
<a class="sourceLine" id="cb3-198" title="198">, { <span class="fl">23</span> , <span class="fl">55</span> }</a>
<a class="sourceLine" id="cb3-199" title="199">, { <span class="fl">24</span> , <span class="fl">28</span> }</a>
<a class="sourceLine" id="cb3-200" title="200">, { <span class="fl">24</span> , <span class="fl">40</span> }</a>
<a class="sourceLine" id="cb3-201" title="201">, { <span class="fl">24</span> , <span class="fl">56</span> }</a>
<a class="sourceLine" id="cb3-202" title="202">, { <span class="fl">25</span> , <span class="fl">29</span> }</a>
<a class="sourceLine" id="cb3-203" title="203">, { <span class="fl">25</span> , <span class="fl">41</span> }</a>
<a class="sourceLine" id="cb3-204" title="204">, { <span class="fl">25</span> , <span class="fl">57</span> }</a>
<a class="sourceLine" id="cb3-205" title="205">, { <span class="fl">26</span> , <span class="fl">30</span> }</a>
<a class="sourceLine" id="cb3-206" title="206">, { <span class="fl">26</span> , <span class="fl">42</span> }</a>
<a class="sourceLine" id="cb3-207" title="207">, { <span class="fl">26</span> , <span class="fl">58</span> }</a>
<a class="sourceLine" id="cb3-208" title="208">, { <span class="fl">27</span> , <span class="fl">31</span> }</a>
<a class="sourceLine" id="cb3-209" title="209">, { <span class="fl">27</span> , <span class="fl">43</span> }</a>
<a class="sourceLine" id="cb3-210" title="210">, { <span class="fl">27</span> , <span class="fl">59</span> }</a>
<a class="sourceLine" id="cb3-211" title="211">, { <span class="fl">28</span> , <span class="fl">44</span> }</a>
<a class="sourceLine" id="cb3-212" title="212">, { <span class="fl">28</span> , <span class="fl">60</span> }</a>
<a class="sourceLine" id="cb3-213" title="213">, { <span class="fl">29</span> , <span class="fl">45</span> }</a>
<a class="sourceLine" id="cb3-214" title="214">, { <span class="fl">29</span> , <span class="fl">61</span> }</a>
<a class="sourceLine" id="cb3-215" title="215">, { <span class="fl">30</span> , <span class="fl">46</span> }</a>
<a class="sourceLine" id="cb3-216" title="216">, { <span class="fl">30</span> , <span class="fl">62</span> }</a>
<a class="sourceLine" id="cb3-217" title="217">, { <span class="fl">31</span> , <span class="fl">47</span> }</a>
<a class="sourceLine" id="cb3-218" title="218">, { <span class="fl">31</span> , <span class="fl">63</span> }</a>
<a class="sourceLine" id="cb3-219" title="219">, { <span class="fl">32</span> , <span class="fl">34</span> }</a>
<a class="sourceLine" id="cb3-220" title="220">, { <span class="fl">32</span> , <span class="fl">48</span> }</a>
<a class="sourceLine" id="cb3-221" title="221">, { <span class="fl">33</span> , <span class="fl">35</span> }</a>
<a class="sourceLine" id="cb3-222" title="222">, { <span class="fl">33</span> , <span class="fl">49</span> }</a>
<a class="sourceLine" id="cb3-223" title="223">, { <span class="fl">34</span> , <span class="fl">50</span> }</a>
<a class="sourceLine" id="cb3-224" title="224">, { <span class="fl">35</span> , <span class="fl">51</span> }</a>
<a class="sourceLine" id="cb3-225" title="225">, { <span class="fl">36</span> , <span class="fl">38</span> }</a>
<a class="sourceLine" id="cb3-226" title="226">, { <span class="fl">36</span> , <span class="fl">52</span> }</a>
<a class="sourceLine" id="cb3-227" title="227">, { <span class="fl">37</span> , <span class="fl">39</span> }</a>
<a class="sourceLine" id="cb3-228" title="228">, { <span class="fl">37</span> , <span class="fl">53</span> }</a>
<a class="sourceLine" id="cb3-229" title="229">, { <span class="fl">38</span> , <span class="fl">54</span> }</a>
<a class="sourceLine" id="cb3-230" title="230">, { <span class="fl">39</span> , <span class="fl">55</span> }</a>
<a class="sourceLine" id="cb3-231" title="231">, { <span class="fl">40</span> , <span class="fl">42</span> }</a>
<a class="sourceLine" id="cb3-232" title="232">, { <span class="fl">40</span> , <span class="fl">56</span> }</a>
<a class="sourceLine" id="cb3-233" title="233">, { <span class="fl">41</span> , <span class="fl">43</span> }</a>
<a class="sourceLine" id="cb3-234" title="234">, { <span class="fl">41</span> , <span class="fl">57</span> }</a>
<a class="sourceLine" id="cb3-235" title="235">, { <span class="fl">42</span> , <span class="fl">58</span> }</a>
<a class="sourceLine" id="cb3-236" title="236">, { <span class="fl">43</span> , <span class="fl">59</span> }</a>
<a class="sourceLine" id="cb3-237" title="237">, { <span class="fl">44</span> , <span class="fl">46</span> }</a>
<a class="sourceLine" id="cb3-238" title="238">, { <span class="fl">44</span> , <span class="fl">60</span> }</a>
<a class="sourceLine" id="cb3-239" title="239">, { <span class="fl">45</span> , <span class="fl">47</span> }</a>
<a class="sourceLine" id="cb3-240" title="240">, { <span class="fl">45</span> , <span class="fl">61</span> }</a>
<a class="sourceLine" id="cb3-241" title="241">, { <span class="fl">46</span> , <span class="fl">62</span> }</a>
<a class="sourceLine" id="cb3-242" title="242">, { <span class="fl">47</span> , <span class="fl">63</span> }</a>
<a class="sourceLine" id="cb3-243" title="243">, { <span class="fl">48</span> , <span class="fl">49</span> }</a>
<a class="sourceLine" id="cb3-244" title="244">, { <span class="fl">50</span> , <span class="fl">51</span> }</a>
<a class="sourceLine" id="cb3-245" title="245">, { <span class="fl">52</span> , <span class="fl">53</span> }</a>
<a class="sourceLine" id="cb3-246" title="246">, { <span class="fl">54</span> , <span class="fl">55</span> }</a>
<a class="sourceLine" id="cb3-247" title="247">, { <span class="fl">56</span> , <span class="fl">57</span> }</a>
<a class="sourceLine" id="cb3-248" title="248">, { <span class="fl">58</span> , <span class="fl">59</span> }</a>
<a class="sourceLine" id="cb3-249" title="249">, { <span class="fl">60</span> , <span class="fl">61</span> }</a>
<a class="sourceLine" id="cb3-250" title="250">, { <span class="fl">62</span> , <span class="fl">63</span> } };</a>
<a class="sourceLine" id="cb3-251" title="251"></a>
<a class="sourceLine" id="cb3-252" title="252"><span class="co">/* tetrahedra */</span></a>
<a class="sourceLine" id="cb3-253" title="253"><span class="kw">#declare tetrahedra </span>= <span class="kw">array</span>[<span class="fl">16</span>][<span class="fl">4</span>]</a>
<a class="sourceLine" id="cb3-254" title="254">{ { <span class="fl">0</span> , <span class="fl">16</span> , <span class="fl">32</span> , <span class="fl">48</span> }</a>
<a class="sourceLine" id="cb3-255" title="255">, { <span class="fl">11</span> , <span class="fl">27</span> , <span class="fl">43</span> , <span class="fl">59</span> }</a>
<a class="sourceLine" id="cb3-256" title="256">, { <span class="fl">12</span> , <span class="fl">28</span> , <span class="fl">44</span> , <span class="fl">60</span> }</a>
<a class="sourceLine" id="cb3-257" title="257">, { <span class="fl">8</span> , <span class="fl">24</span> , <span class="fl">40</span> , <span class="fl">56</span> }</a>
<a class="sourceLine" id="cb3-258" title="258">, { <span class="fl">9</span> , <span class="fl">25</span> , <span class="fl">41</span> , <span class="fl">57</span> }</a>
<a class="sourceLine" id="cb3-259" title="259">, { <span class="fl">15</span> , <span class="fl">31</span> , <span class="fl">47</span> , <span class="fl">63</span> }</a>
<a class="sourceLine" id="cb3-260" title="260">, { <span class="fl">13</span> , <span class="fl">29</span> , <span class="fl">45</span> , <span class="fl">61</span> }</a>
<a class="sourceLine" id="cb3-261" title="261">, { <span class="fl">14</span> , <span class="fl">30</span> , <span class="fl">46</span> , <span class="fl">62</span> }</a>
<a class="sourceLine" id="cb3-262" title="262">, { <span class="fl">10</span> , <span class="fl">26</span> , <span class="fl">42</span> , <span class="fl">58</span> }</a>
<a class="sourceLine" id="cb3-263" title="263">, { <span class="fl">3</span> , <span class="fl">19</span> , <span class="fl">35</span> , <span class="fl">51</span> }</a>
<a class="sourceLine" id="cb3-264" title="264">, { <span class="fl">2</span> , <span class="fl">18</span> , <span class="fl">34</span> , <span class="fl">50</span> }</a>
<a class="sourceLine" id="cb3-265" title="265">, { <span class="fl">1</span> , <span class="fl">17</span> , <span class="fl">33</span> , <span class="fl">49</span> }</a>
<a class="sourceLine" id="cb3-266" title="266">, { <span class="fl">4</span> , <span class="fl">20</span> , <span class="fl">36</span> , <span class="fl">52</span> }</a>
<a class="sourceLine" id="cb3-267" title="267">, { <span class="fl">5</span> , <span class="fl">21</span> , <span class="fl">37</span> , <span class="fl">53</span> }</a>
<a class="sourceLine" id="cb3-268" title="268">, { <span class="fl">6</span> , <span class="fl">22</span> , <span class="fl">38</span> , <span class="fl">54</span> }</a>
<a class="sourceLine" id="cb3-269" title="269">, { <span class="fl">7</span> , <span class="fl">23</span> , <span class="fl">39</span> , <span class="fl">55</span> } };</a>
<a class="sourceLine" id="cb3-270" title="270"></a>
<a class="sourceLine" id="cb3-271" title="271"><span class="kw">#declare faces </span>= <span class="kw">array</span>[<span class="fl">64</span>][<span class="fl">3</span>];</a>
<a class="sourceLine" id="cb3-272" title="272">#for(i, <span class="fl">0</span>, <span class="fl">15</span>)</a>
<a class="sourceLine" id="cb3-273" title="273">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i][<span class="fl">0</span>] = tetrahedra[i][<span class="fl">0</span>];</a>
<a class="sourceLine" id="cb3-274" title="274">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i][<span class="fl">1</span>] = tetrahedra[i][<span class="fl">1</span>];</a>
<a class="sourceLine" id="cb3-275" title="275">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i][<span class="fl">2</span>] = tetrahedra[i][<span class="fl">2</span>];</a>
<a class="sourceLine" id="cb3-276" title="276">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">1</span>][<span class="fl">0</span>] = tetrahedra[i][<span class="fl">0</span>];</a>
<a class="sourceLine" id="cb3-277" title="277">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">1</span>][<span class="fl">1</span>] = tetrahedra[i][<span class="fl">1</span>];</a>
<a class="sourceLine" id="cb3-278" title="278">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">1</span>][<span class="fl">2</span>] = tetrahedra[i][<span class="fl">3</span>];</a>
<a class="sourceLine" id="cb3-279" title="279">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">2</span>][<span class="fl">0</span>] = tetrahedra[i][<span class="fl">0</span>];</a>
<a class="sourceLine" id="cb3-280" title="280">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">2</span>][<span class="fl">1</span>] = tetrahedra[i][<span class="fl">2</span>];</a>
<a class="sourceLine" id="cb3-281" title="281">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">2</span>][<span class="fl">2</span>] = tetrahedra[i][<span class="fl">3</span>];</a>
<a class="sourceLine" id="cb3-282" title="282">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">3</span>][<span class="fl">0</span>] = tetrahedra[i][<span class="fl">1</span>];</a>
<a class="sourceLine" id="cb3-283" title="283">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">3</span>][<span class="fl">1</span>] = tetrahedra[i][<span class="fl">2</span>];</a>
<a class="sourceLine" id="cb3-284" title="284">    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">3</span>][<span class="fl">2</span>] = tetrahedra[i][<span class="fl">3</span>];</a>
<a class="sourceLine" id="cb3-285" title="285"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-286" title="286"></a>
<a class="sourceLine" id="cb3-287" title="287"></a>
<a class="sourceLine" id="cb3-288" title="288"><span class="co">/* rotation in 4D space */</span></a>
<a class="sourceLine" id="cb3-289" title="289"><span class="kw">#macro rotate4d</span>(theta, phi, xi, vec)</a>
<a class="sourceLine" id="cb3-290" title="290">    <span class="kw">#local a </span>= <span class="kw">cos</span>(xi);</a>
<a class="sourceLine" id="cb3-291" title="291">    <span class="kw">#local b </span>= <span class="kw">sin</span>(theta)*<span class="kw">cos</span>(phi)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb3-292" title="292">    <span class="kw">#local c </span>= <span class="kw">sin</span>(theta)*<span class="kw">sin</span>(phi)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb3-293" title="293">    <span class="kw">#local d </span>= <span class="kw">cos</span>(theta)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb3-294" title="294">    <span class="kw">#local p </span>= vec.<span class="kw">x</span>;</a>
<a class="sourceLine" id="cb3-295" title="295">    <span class="kw">#local q </span>= vec.<span class="kw">y</span>;</a>
<a class="sourceLine" id="cb3-296" title="296">    <span class="kw">#local r </span>= vec.<span class="kw">z</span>;</a>
<a class="sourceLine" id="cb3-297" title="297">    <span class="kw">#local s </span>= vec.<span class="kw">t</span>;</a>
<a class="sourceLine" id="cb3-298" title="298">    &lt; a*p - b*q - c*r - d*s</a>
<a class="sourceLine" id="cb3-299" title="299">    , a*q + b*p + c*s - d*r</a>
<a class="sourceLine" id="cb3-300" title="300">    , a*r - b*s + c*p + d*q</a>
<a class="sourceLine" id="cb3-301" title="301">    , a*s + b*r - c*q + d*p &gt;</a>
<a class="sourceLine" id="cb3-302" title="302"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-303" title="303"></a>
<a class="sourceLine" id="cb3-304" title="304"><span class="co">/* stereographic projection */</span></a>
<a class="sourceLine" id="cb3-305" title="305"><span class="kw">#macro StereographicProjection</span>(q, r)</a>
<a class="sourceLine" id="cb3-306" title="306">    &lt;q.<span class="kw">x</span>,q.<span class="kw">y</span>,q.<span class="kw">z</span>&gt;/(r-q.<span class="kw">t</span>)</a>
<a class="sourceLine" id="cb3-307" title="307"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-308" title="308"></a>
<a class="sourceLine" id="cb3-309" title="309"><span class="co">/* rotated and projected vertices */</span></a>
<a class="sourceLine" id="cb3-310" title="310"><span class="kw">#macro ProjectedVertices</span>(theta, phi, xi, r)</a>
<a class="sourceLine" id="cb3-311" title="311">    <span class="kw">#local out </span>= <span class="kw">array</span>[<span class="fl">64</span>];</a>
<a class="sourceLine" id="cb3-312" title="312">    #for(i, <span class="fl">0</span>, <span class="fl">63</span>)</a>
<a class="sourceLine" id="cb3-313" title="313">        <span class="kw">#local out</span>[i] = StereographicProjection(</a>
<a class="sourceLine" id="cb3-314" title="314">                            rotate4d(theta,phi,xi,vertices[i]), r</a>
<a class="sourceLine" id="cb3-315" title="315">                        );</a>
<a class="sourceLine" id="cb3-316" title="316">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-317" title="317">    out</a>
<a class="sourceLine" id="cb3-318" title="318"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-319" title="319"></a>
<a class="sourceLine" id="cb3-320" title="320"><span class="co">/* macro spherical segment */</span></a>
<a class="sourceLine" id="cb3-321" title="321"><span class="kw">#macro vlength4</span>(P)</a>
<a class="sourceLine" id="cb3-322" title="322">    <span class="kw">sqrt</span>(P.<span class="kw">x</span>*P.<span class="kw">x</span> + P.<span class="kw">y</span>*P.<span class="kw">y</span> + P.<span class="kw">z</span>*P.<span class="kw">z</span> + P.<span class="kw">t</span>*P.<span class="kw">t</span>)</a>
<a class="sourceLine" id="cb3-323" title="323"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-324" title="324"></a>
<a class="sourceLine" id="cb3-325" title="325"><span class="kw">#macro sphericalSegment</span>(P, Q, r, n)</a>
<a class="sourceLine" id="cb3-326" title="326">    <span class="kw">#local out </span>= <span class="kw">array</span>[n+<span class="fl">1</span>];</a>
<a class="sourceLine" id="cb3-327" title="327">    #for(i, <span class="fl">0</span>, n)</a>
<a class="sourceLine" id="cb3-328" title="328">        <span class="kw">#local pt </span>= P + (i/n)*(Q-P);</a>
<a class="sourceLine" id="cb3-329" title="329">        <span class="kw">#local out</span>[i] = r/vlength4(pt) * pt;</a>
<a class="sourceLine" id="cb3-330" title="330">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-331" title="331">    out</a>
<a class="sourceLine" id="cb3-332" title="332"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-333" title="333"></a>
<a class="sourceLine" id="cb3-334" title="334"><span class="co">/* macro to draw an edge */</span></a>
<a class="sourceLine" id="cb3-335" title="335"><span class="kw">#macro Edge</span>(verts, v1, v2, theta, phi, xi, r, Tex)</a>
<a class="sourceLine" id="cb3-336" title="336">    <span class="kw">#local P </span>= verts[v1];</a>
<a class="sourceLine" id="cb3-337" title="337">    <span class="kw">#local Q </span>= verts[v2];</a>
<a class="sourceLine" id="cb3-338" title="338">    <span class="kw">#local PQ </span>= sphericalSegment(P, Q, r, <span class="fl">100</span>);</a>
<a class="sourceLine" id="cb3-339" title="339">    <span class="kw">sphere_sweep</span> {</a>
<a class="sourceLine" id="cb3-340" title="340">        <span class="kw">b_spline</span> <span class="fl">101</span></a>
<a class="sourceLine" id="cb3-341" title="341">        #for(k,<span class="fl">0</span>,<span class="fl">100</span>)</a>
<a class="sourceLine" id="cb3-342" title="342">            <span class="kw">#local O </span>= </a>
<a class="sourceLine" id="cb3-343" title="343">                StereographicProjection(rotate4d(theta,phi,xi,PQ[k]), r);</a>
<a class="sourceLine" id="cb3-344" title="344">            O <span class="kw">log</span>(<span class="fl">1</span>+<span class="kw">vlength</span>(O)/<span class="fl">4</span>)/<span class="fl">2</span></a>
<a class="sourceLine" id="cb3-345" title="345">        <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-346" title="346">        <span class="kw">texture</span> { </a>
<a class="sourceLine" id="cb3-347" title="347">            Tex</a>
<a class="sourceLine" id="cb3-348" title="348">        }</a>
<a class="sourceLine" id="cb3-349" title="349">    }</a>
<a class="sourceLine" id="cb3-350" title="350"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-351" title="351"></a>
<a class="sourceLine" id="cb3-352" title="352"><span class="co">/* stereographic subdivision (to fill the triangular faces) */</span></a>
<a class="sourceLine" id="cb3-353" title="353"><span class="kw">#macro midpoint4</span>(A, B, r)</a>
<a class="sourceLine" id="cb3-354" title="354">    <span class="kw">#local xmid </span>= (A.<span class="kw">x</span> + B.<span class="kw">x</span>)/<span class="fl">2</span>;</a>
<a class="sourceLine" id="cb3-355" title="355">    <span class="kw">#local ymid </span>= (A.<span class="kw">y</span> + B.<span class="kw">y</span>)/<span class="fl">2</span>;</a>
<a class="sourceLine" id="cb3-356" title="356">    <span class="kw">#local zmid </span>= (A.<span class="kw">z</span> + B.<span class="kw">z</span>)/<span class="fl">2</span>;</a>
<a class="sourceLine" id="cb3-357" title="357">    <span class="kw">#local tmid </span>= (A.<span class="kw">t</span> + B.<span class="kw">t</span>)/<span class="fl">2</span>;</a>
<a class="sourceLine" id="cb3-358" title="358">    <span class="kw">#local lg </span>= <span class="kw">sqrt</span>(xmid*xmid + ymid*ymid + zmid*zmid + tmid*tmid) / r;</a>
<a class="sourceLine" id="cb3-359" title="359">    &lt; xmid / lg, ymid / lg, zmid / lg, tmid / lg &gt;</a>
<a class="sourceLine" id="cb3-360" title="360"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-361" title="361"></a>
<a class="sourceLine" id="cb3-362" title="362"><span class="kw">#macro subdiv0</span>(A, B, C, r)</a>
<a class="sourceLine" id="cb3-363" title="363">    <span class="kw">#local mAB </span>= midpoint4(A, B, r);</a>
<a class="sourceLine" id="cb3-364" title="364">    <span class="kw">#local mAC </span>= midpoint4(A, C, r);</a>
<a class="sourceLine" id="cb3-365" title="365">    <span class="kw">#local mBC </span>= midpoint4(B, C, r);</a>
<a class="sourceLine" id="cb3-366" title="366">    <span class="kw">#local trgl1 </span>= <span class="kw">array</span>[<span class="fl">3</span>] {A, mAB, mAC};</a>
<a class="sourceLine" id="cb3-367" title="367">    <span class="kw">#local trgl2 </span>= <span class="kw">array</span>[<span class="fl">3</span>] {B, mAB, mBC};</a>
<a class="sourceLine" id="cb3-368" title="368">    <span class="kw">#local trgl3 </span>= <span class="kw">array</span>[<span class="fl">3</span>] {C, mBC, mAC};</a>
<a class="sourceLine" id="cb3-369" title="369">    <span class="kw">#local trgl4 </span>= <span class="kw">array</span>[<span class="fl">3</span>] {mAB, mAC, mBC};</a>
<a class="sourceLine" id="cb3-370" title="370">    <span class="kw">array</span>[<span class="fl">4</span>] {trgl1, trgl2, trgl3, trgl4}</a>
<a class="sourceLine" id="cb3-371" title="371"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-372" title="372"></a>
<a class="sourceLine" id="cb3-373" title="373"><span class="kw">#macro subdiv</span>(A, B, C, r, depth)</a>
<a class="sourceLine" id="cb3-374" title="374">    <span class="ot">#if</span>(depth=<span class="fl">1</span>)</a>
<a class="sourceLine" id="cb3-375" title="375">        <span class="kw">#local out </span>= subdiv0(A, B, C, r);</a>
<a class="sourceLine" id="cb3-376" title="376">    <span class="ot">#else</span></a>
<a class="sourceLine" id="cb3-377" title="377">        <span class="kw">#local triangles </span>= subdiv(A, B, C, r, depth<span class="fl">-1</span>);</a>
<a class="sourceLine" id="cb3-378" title="378">        <span class="kw">#local out </span>= <span class="kw">array</span>[<span class="kw">pow</span>(<span class="fl">4</span>,depth)];</a>
<a class="sourceLine" id="cb3-379" title="379">        #for(i, <span class="fl">0</span>, <span class="kw">pow</span>(<span class="fl">4</span>,depth<span class="fl">-1</span>)-<span class="fl">1</span>)</a>
<a class="sourceLine" id="cb3-380" title="380">            <span class="kw">#local trgl </span>= triangles[i];</a>
<a class="sourceLine" id="cb3-381" title="381">            <span class="kw">#local trgls </span>= subdiv0(trgl[<span class="fl">0</span>], trgl[<span class="fl">1</span>], trgl[<span class="fl">2</span>], r);</a>
<a class="sourceLine" id="cb3-382" title="382">            <span class="kw">#local out</span>[<span class="fl">4</span>*i] = trgls[<span class="fl">0</span>];</a>
<a class="sourceLine" id="cb3-383" title="383">            <span class="kw">#local out</span>[<span class="fl">4</span>*i+<span class="fl">1</span>] = trgls[<span class="fl">1</span>];</a>
<a class="sourceLine" id="cb3-384" title="384">            <span class="kw">#local out</span>[<span class="fl">4</span>*i+<span class="fl">2</span>] = trgls[<span class="fl">2</span>];</a>
<a class="sourceLine" id="cb3-385" title="385">            <span class="kw">#local out</span>[<span class="fl">4</span>*i+<span class="fl">3</span>] = trgls[<span class="fl">3</span>];</a>
<a class="sourceLine" id="cb3-386" title="386">        <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-387" title="387">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-388" title="388">    out</a>
<a class="sourceLine" id="cb3-389" title="389"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-390" title="390"></a>
<a class="sourceLine" id="cb3-391" title="391"><span class="co">/*-------------------------------------------*/</span></a>
<a class="sourceLine" id="cb3-392" title="392"><span class="co">/*-----      draw the polychoron       ------*/</span></a>
<a class="sourceLine" id="cb3-393" title="393"><span class="co">/*-------------------------------------------*/</span></a>
<a class="sourceLine" id="cb3-394" title="394"><span class="kw">#declare theta </span>= <span class="fl">pi</span>/<span class="fl">2</span>;</a>
<a class="sourceLine" id="cb3-395" title="395"><span class="kw">#declare phi </span>= <span class="fl">0</span>;</a>
<a class="sourceLine" id="cb3-396" title="396"><span class="kw">#declare xi </span>= <span class="fl">2</span>*<span class="kw">frame_number</span>*<span class="fl">pi</span>/<span class="fl">180</span>;</a>
<a class="sourceLine" id="cb3-397" title="397"><span class="kw">#declare r </span>= <span class="kw">sqrt</span>(<span class="fl">1</span>+<span class="fl">3</span>*sqr2p1*sqr2p1); </a>
<a class="sourceLine" id="cb3-398" title="398"><span class="kw">#declare depth </span>= <span class="fl">5</span>;</a>
<a class="sourceLine" id="cb3-399" title="399"></a>
<a class="sourceLine" id="cb3-400" title="400"><span class="kw">#declare vs </span>= ProjectedVertices(theta, phi, xi, r);</a>
<a class="sourceLine" id="cb3-401" title="401"></a>
<a class="sourceLine" id="cb3-402" title="402"><span class="kw">#declare stereoTriangles </span>= <span class="kw">array</span>[<span class="fl">64</span>];</a>
<a class="sourceLine" id="cb3-403" title="403">#for(i, <span class="fl">0</span>, <span class="fl">63</span>)</a>
<a class="sourceLine" id="cb3-404" title="404">    <span class="kw">#local triangles4 </span>= </a>
<a class="sourceLine" id="cb3-405" title="405">        subdiv(</a>
<a class="sourceLine" id="cb3-406" title="406">            vertices[faces[i][<span class="fl">0</span>]], </a>
<a class="sourceLine" id="cb3-407" title="407">            vertices[faces[i][<span class="fl">1</span>]], </a>
<a class="sourceLine" id="cb3-408" title="408">            vertices[faces[i][<span class="fl">2</span>]], r, depth);</a>
<a class="sourceLine" id="cb3-409" title="409">    <span class="kw">#declare stereoTriangles</span>[i] = <span class="kw">array</span>[<span class="kw">dimension_size</span>(triangles4,<span class="fl">1</span>)][<span class="fl">3</span>];</a>
<a class="sourceLine" id="cb3-410" title="410">    #for(j, <span class="fl">0</span>, <span class="kw">dimension_size</span>(triangles4,<span class="fl">1</span>)-<span class="fl">1</span>)</a>
<a class="sourceLine" id="cb3-411" title="411">        <span class="kw">#local trgl4 </span>= triangles4[j];</a>
<a class="sourceLine" id="cb3-412" title="412">        <span class="kw">#declare stereoTriangles</span>[i][j][<span class="fl">0</span>] = </a>
<a class="sourceLine" id="cb3-413" title="413">            StereographicProjection(rotate4d(theta, phi, xi, trgl4[<span class="fl">0</span>]), r);</a>
<a class="sourceLine" id="cb3-414" title="414">        <span class="kw">#declare stereoTriangles</span>[i][j][<span class="fl">1</span>] = </a>
<a class="sourceLine" id="cb3-415" title="415">            StereographicProjection(rotate4d(theta, phi, xi, trgl4[<span class="fl">1</span>]), r);</a>
<a class="sourceLine" id="cb3-416" title="416">        <span class="kw">#declare stereoTriangles</span>[i][j][<span class="fl">2</span>] = </a>
<a class="sourceLine" id="cb3-417" title="417">            StereographicProjection(rotate4d(theta, phi, xi, trgl4[<span class="fl">2</span>]), r);</a>
<a class="sourceLine" id="cb3-418" title="418">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-419" title="419"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-420" title="420"></a>
<a class="sourceLine" id="cb3-421" title="421"><span class="kw">#declare edgeTexture </span>= <span class="kw">texture</span> {</a>
<a class="sourceLine" id="cb3-422" title="422">    <span class="kw">pigment</span> { <span class="kw">color</span> DarkPurple }</a>
<a class="sourceLine" id="cb3-423" title="423">    <span class="kw">finish</span> {</a>
<a class="sourceLine" id="cb3-424" title="424">      <span class="kw">ambient</span> <span class="fl">.1</span></a>
<a class="sourceLine" id="cb3-425" title="425">      <span class="kw">diffuse</span> <span class="fl">.9</span></a>
<a class="sourceLine" id="cb3-426" title="426">      <span class="kw">reflection</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb3-427" title="427">      <span class="kw">specular</span> <span class="fl">1</span></a>
<a class="sourceLine" id="cb3-428" title="428">      <span class="kw">metallic</span></a>
<a class="sourceLine" id="cb3-429" title="429">    }</a>
<a class="sourceLine" id="cb3-430" title="430">};</a>
<a class="sourceLine" id="cb3-431" title="431"></a>
<a class="sourceLine" id="cb3-432" title="432"><span class="kw">object</span> {</a>
<a class="sourceLine" id="cb3-433" title="433">    <span class="kw">union</span> {</a>
<a class="sourceLine" id="cb3-434" title="434">        <span class="co">/* draw edges */</span></a>
<a class="sourceLine" id="cb3-435" title="435">        #for(i, <span class="fl">0</span>, <span class="fl">127</span>)</a>
<a class="sourceLine" id="cb3-436" title="436">            Edge(vertices, edges[i][<span class="fl">0</span>], edges[i][<span class="fl">1</span>], </a>
<a class="sourceLine" id="cb3-437" title="437">                    theta, phi, xi, r, edgeTexture)</a>
<a class="sourceLine" id="cb3-438" title="438">        <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-439" title="439">        <span class="co">/* draw vertices */</span> </a>
<a class="sourceLine" id="cb3-440" title="440">        #for(i,<span class="fl">0</span>,<span class="fl">63</span>)</a>
<a class="sourceLine" id="cb3-441" title="441">            <span class="kw">sphere</span> {</a>
<a class="sourceLine" id="cb3-442" title="442">                vs[i], <span class="kw">vlength</span>(vs[i])/<span class="fl">15</span></a>
<a class="sourceLine" id="cb3-443" title="443">                <span class="kw">texture</span> { edgeTexture }</a>
<a class="sourceLine" id="cb3-444" title="444">            }</a>
<a class="sourceLine" id="cb3-445" title="445">        <span class="ot">#end</span>  </a>
<a class="sourceLine" id="cb3-446" title="446">        <span class="co">/* fill triangles */</span></a>
<a class="sourceLine" id="cb3-447" title="447">        <span class="kw">mesh</span> {</a>
<a class="sourceLine" id="cb3-448" title="448">            #for(i, <span class="fl">0</span>, <span class="fl">63</span>)</a>
<a class="sourceLine" id="cb3-449" title="449">                <span class="kw">#local trgl </span>= stereoTriangles[i];</a>
<a class="sourceLine" id="cb3-450" title="450">                #for(j, <span class="fl">0</span>, <span class="kw">dimension_size</span>(trgl,<span class="fl">1</span>)-<span class="fl">1</span>)</a>
<a class="sourceLine" id="cb3-451" title="451">                    <span class="kw">triangle</span> {</a>
<a class="sourceLine" id="cb3-452" title="452">                        trgl[j][<span class="fl">0</span>], trgl[j][<span class="fl">1</span>], trgl[j][<span class="fl">2</span>]</a>
<a class="sourceLine" id="cb3-453" title="453">                    }</a>
<a class="sourceLine" id="cb3-454" title="454">                <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-455" title="455">            <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-456" title="456">            <span class="kw">texture</span> {</a>
<a class="sourceLine" id="cb3-457" title="457">                <span class="kw">pigment</span> { Red }</a>
<a class="sourceLine" id="cb3-458" title="458">                <span class="kw">finish</span> {</a>
<a class="sourceLine" id="cb3-459" title="459">                    <span class="kw">ambient</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb3-460" title="460">                    <span class="kw">reflection</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb3-461" title="461">                    <span class="kw">brilliance</span> <span class="fl">4</span></a>
<a class="sourceLine" id="cb3-462" title="462">                }</a>
<a class="sourceLine" id="cb3-463" title="463">            }</a>
<a class="sourceLine" id="cb3-464" title="464">        }</a>
<a class="sourceLine" id="cb3-465" title="465">     }</a>
<a class="sourceLine" id="cb3-466" title="466">     <span class="kw">scale</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb3-467" title="467">     <span class="kw">translate</span> &lt;-<span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">-25</span>&gt;</a>
<a class="sourceLine" id="cb3-468" title="468">}</a></code></pre></div>
<p><img src="figures/truncatedTesseract_stereographic_povray.gif" /></p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">¬´ Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->

  <!-- Google Prettify -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script> -->
  <script src="../libraries/highlighters/prettify/js/lang-r.js"></script>
  <script>
    var pres = document.getElementsByTagName("pre");
    for (var i = 0; i < pres.length; ++i) {
      
        pres[i].className = pres[i].className + " prettyprint linenums";
      
    }
    prettyPrint();
  </script> 


</html>