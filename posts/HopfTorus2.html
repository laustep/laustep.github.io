<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Back to the parametric Hopf torus</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
    <link href="../libraries/highlighters/prettify/css/minimal.css" rel="stylesheet"> 
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-3">
        <div style="float:right;clear:both;margin-right:50px;margin-top:150px;">
          <a href="https://www.r-bloggers.com/">
            <img src="https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png" alt="stla" width="100%" />
          </a>
          <br />
          <a href="http://t-redactyl.io/">
            <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:29px;">Standard error</span>
          </a>
          <a href="http://timelyportfolio.blogspot.be/">
            <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:27px;">Timely portfolio</span>
          </a>
          <br />
          <a href="https://antoineguillot.wordpress.com/blog/">
            <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:25px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
          </a>
          <br />
          <a href="https://fronkonstin.com/">
            <span style="color:black;background-color:gold;font-weight:bold;font-size:32px;border:3px solid;border-color:gold;">Fronkonstin</span>
          </a>
        </div>
      </div>

      <div class="main col-sm-9">
        <div id="header">
          <div id="logo" style="position:absolute;">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Back to the parametric Hopf torus</h1> 
          <div class="info">
    Posted on April 12, 2020
    
        by Stéphane Laurent
    
</div>
<div class="info">
    
    Tags: <a href="../tags/R.html">R</a>, <a href="../tags/graphics.html">graphics</a>, <a href="../tags/rgl.html">rgl</a>, <a href="../tags/geometry.html">geometry</a>, <a href="../tags/maths.html">maths</a>
    
</div>

<p>In a <a href="./HopfTorusParametric.html">previous post</a>, I explained how to get a parameterization of a Hopf cylinder or torus. There is a clearer way, which I present here.</p>
<p>For the Hopf map, the preimage of a point <span class="math inline">\(p=(p_x,p_y,p_z)\)</span> on the unit sphere <span class="math inline">\(S^2\)</span> is the circle on <span class="math inline">\(S^3\)</span> with parametrization: <span class="math display">\[
\begin{array}{ccc}
\mathcal{C}_p \colon &amp; (0,2\pi[ &amp; \longrightarrow &amp; S^3 \\
 &amp; \phi &amp; \longmapsto &amp; \mathcal{C}_p(\phi) 
\end{array}
\]</span> where <span class="math display">\[
\mathcal{C}_p(\phi) = 
\frac{1}{\sqrt{2(1+p_z)}}
\begin{pmatrix}
(1+p_z) \cos(\phi) \\
p_x \sin(\phi) - p_y \cos(\phi) \\
p_x \cos(\phi) + p_y \sin(\phi) \\
(1+p_z) \sin(\phi)
\end{pmatrix}.
\]</span></p>
<p>Now consider a spherical curve. That is, let <span class="math inline">\(\Gamma\)</span> be a function mapping an interval <span class="math inline">\(I \subset \mathbb{R}\)</span> to the unit sphere <span class="math inline">\(S^2\)</span>. Then the Hopf cylinder corresponding to <span class="math inline">\(\Gamma\)</span> has parameterization <span class="math display">\[
\begin{array}{ccc}
H_\Gamma \colon &amp; I \times (0,2\pi[ &amp; \longrightarrow &amp; S^3 \\
 &amp; (t, \phi) &amp; \longmapsto &amp; \mathcal{C}_{\Gamma(t)}(\phi) 
\end{array}.
\]</span> Recall the <a href="./HopfTorusTennisBall.html">tennis ball curve</a> example, given for a real constant <span class="math inline">\(A\)</span> and an integer constant <span class="math inline">\(n\)</span> by: <span class="math display">\[
\Gamma(t) = 
\begin{pmatrix}
\sin\bigl(\pi/2 - (\pi/2 - A) \cos(nt)\bigr) 
\cos\bigl(t + A \sin(2nt)\bigr) \\ 
\sin\bigl(\pi/2 - (\pi/2 - A) \cos(nt)\bigr) 
\sin\bigl(t + A \sin(2nt)\bigr) \\ 
\cos\bigl(\pi/2 - (\pi/2 - A) \cos(nt)\bigr)
\end{pmatrix}, \quad t \in (0,2\pi[.
\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">A &lt;-<span class="st"> </span><span class="fl">0.44</span></a>
<a class="sourceLine" id="cb1-2" title="2">n &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1-3" title="3">Gamma &lt;-<span class="st"> </span><span class="cf">function</span>(t){</a>
<a class="sourceLine" id="cb1-4" title="4">  alpha &lt;-<span class="st"> </span>pi<span class="op">/</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(pi<span class="op">/</span><span class="dv">2</span><span class="op">-</span>A)<span class="op">*</span><span class="kw">cos</span>(n<span class="op">*</span>t)</a>
<a class="sourceLine" id="cb1-5" title="5">  beta &lt;-<span class="st"> </span>t <span class="op">+</span><span class="st"> </span>A<span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">*</span>t)</a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="kw">sin</span>(alpha) <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(beta),</a>
<a class="sourceLine" id="cb1-8" title="8">    <span class="kw">sin</span>(alpha) <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(beta),</a>
<a class="sourceLine" id="cb1-9" title="9">    <span class="kw">cos</span>(alpha)</a>
<a class="sourceLine" id="cb1-10" title="10">  )</a>
<a class="sourceLine" id="cb1-11" title="11">}</a>
<a class="sourceLine" id="cb1-12" title="12">HopfInverse &lt;-<span class="st"> </span><span class="cf">function</span>(p, phi){</a>
<a class="sourceLine" id="cb1-13" title="13">  <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb1-14" title="14">    (<span class="dv">1</span><span class="op">+</span>p[<span class="dv">3</span>])<span class="op">*</span><span class="kw">cos</span>(phi),</a>
<a class="sourceLine" id="cb1-15" title="15">    p[<span class="dv">1</span>]<span class="op">*</span><span class="kw">sin</span>(phi) <span class="op">-</span><span class="st"> </span>p[<span class="dv">2</span>]<span class="op">*</span><span class="kw">cos</span>(phi), </a>
<a class="sourceLine" id="cb1-16" title="16">    p[<span class="dv">1</span>]<span class="op">*</span><span class="kw">cos</span>(phi) <span class="op">+</span><span class="st"> </span>p[<span class="dv">2</span>]<span class="op">*</span><span class="kw">sin</span>(phi),</a>
<a class="sourceLine" id="cb1-17" title="17">    (<span class="dv">1</span><span class="op">+</span>p[<span class="dv">3</span>])<span class="op">*</span><span class="kw">sin</span>(phi)</a>
<a class="sourceLine" id="cb1-18" title="18">  ) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>p[<span class="dv">3</span>])) </a>
<a class="sourceLine" id="cb1-19" title="19">}</a>
<a class="sourceLine" id="cb1-20" title="20">Stereo &lt;-<span class="st"> </span><span class="cf">function</span>(q){</a>
<a class="sourceLine" id="cb1-21" title="21">  <span class="dv">2</span><span class="op">*</span>q[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>q[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb1-22" title="22">}</a>
<a class="sourceLine" id="cb1-23" title="23">F &lt;-<span class="st"> </span><span class="cf">function</span>(t, phi){</a>
<a class="sourceLine" id="cb1-24" title="24">  <span class="kw">Stereo</span>(<span class="kw">HopfInverse</span>(<span class="kw">Gamma</span>(t), phi))</a>
<a class="sourceLine" id="cb1-25" title="25">}</a></code></pre></div>
<p>Now we’re ready to plot the stereographic projection of the Hopf torus with <code>misc3d</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">fx &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">F</span>(u,v)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb2-2" title="2">fy &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">F</span>(u,v)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb2-3" title="3">fz &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">F</span>(u,v)[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">library</span>(misc3d)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">parametric3d</span>(fx, fy, fz, <span class="dt">umin =</span> <span class="dv">0</span>, <span class="dt">umax =</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin =</span> <span class="dv">0</span>, <span class="dt">vmax =</span> <span class="dv">2</span><span class="op">*</span>pi, </a>
<a class="sourceLine" id="cb2-6" title="6">             <span class="dt">n =</span> <span class="dv">300</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;#363940&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">rgl<span class="op">::</span><span class="kw">view3d</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dt">zoom =</span> <span class="fl">0.65</span>)</a></code></pre></div>
<p><img src="./figures/HopfTorus_grey.png" /></p>
<p>A ring cyclide is a Hopf torus. It corresponds to the case when <span class="math inline">\(\Gamma\)</span> describes a circle on the unit sphere <span class="math inline">\(S^2\)</span>. Below is a R function to compute such a circle.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># helper function: plane passing by points p1, p2, p3 </span></a>
<a class="sourceLine" id="cb3-2" title="2">plane3pts &lt;-<span class="st"> </span><span class="cf">function</span>(p1,p2,p3){ </a>
<a class="sourceLine" id="cb3-3" title="3">    xcoef &lt;-<span class="st"> </span>(p1[<span class="dv">2</span>]<span class="op">-</span>p2[<span class="dv">2</span>])<span class="op">*</span>(p2[<span class="dv">3</span>]<span class="op">-</span>p3[<span class="dv">3</span>])<span class="op">-</span>(p1[<span class="dv">3</span>]<span class="op">-</span>p2[<span class="dv">3</span>])<span class="op">*</span>(p2[<span class="dv">2</span>]<span class="op">-</span>p3[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb3-4" title="4">    ycoef &lt;-<span class="st"> </span>(p1[<span class="dv">3</span>]<span class="op">-</span>p2[<span class="dv">3</span>])<span class="op">*</span>(p2[<span class="dv">1</span>]<span class="op">-</span>p3[<span class="dv">1</span>])<span class="op">-</span>(p1[<span class="dv">1</span>]<span class="op">-</span>p2[<span class="dv">1</span>])<span class="op">*</span>(p2[<span class="dv">3</span>]<span class="op">-</span>p3[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb3-5" title="5">    zcoef &lt;-<span class="st"> </span>(p1[<span class="dv">1</span>]<span class="op">-</span>p2[<span class="dv">1</span>])<span class="op">*</span>(p2[<span class="dv">2</span>]<span class="op">-</span>p3[<span class="dv">2</span>])<span class="op">-</span>(p1[<span class="dv">2</span>]<span class="op">-</span>p2[<span class="dv">2</span>])<span class="op">*</span>(p2[<span class="dv">1</span>]<span class="op">-</span>p3[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb3-6" title="6">    offset &lt;-<span class="st"> </span>p1[<span class="dv">1</span>]<span class="op">*</span>xcoef <span class="op">+</span><span class="st"> </span>p1[<span class="dv">2</span>]<span class="op">*</span>ycoef <span class="op">+</span><span class="st"> </span>p1[<span class="dv">3</span>]<span class="op">*</span>zcoef</a>
<a class="sourceLine" id="cb3-7" title="7">    <span class="kw">c</span>(xcoef, ycoef, zcoef, offset)</a>
<a class="sourceLine" id="cb3-8" title="8">}</a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co"># helper function: cross product </span></a>
<a class="sourceLine" id="cb3-11" title="11">cross &lt;-<span class="st"> </span><span class="cf">function</span>(v, w){ </a>
<a class="sourceLine" id="cb3-12" title="12">  <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb3-13" title="13">    v[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span>v[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb3-14" title="14">    v[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>v[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">3</span>], </a>
<a class="sourceLine" id="cb3-15" title="15">    v[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>v[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb3-16" title="16">  )</a>
<a class="sourceLine" id="cb3-17" title="17">}</a>
<a class="sourceLine" id="cb3-18" title="18"></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co"># circle passing by points three points p1, p2, p3 </span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co"># given in Cartesian coordinates</span></a>
<a class="sourceLine" id="cb3-21" title="21">circle3pts &lt;-<span class="st"> </span><span class="cf">function</span>(p1, p2, p3){</a>
<a class="sourceLine" id="cb3-22" title="22">  p12 &lt;-<span class="st"> </span>(p1<span class="op">+</span>p2)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-23" title="23">  p23 &lt;-<span class="st"> </span>(p2<span class="op">+</span>p3)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-24" title="24">  v12 &lt;-<span class="st"> </span>p2<span class="op">-</span>p1</a>
<a class="sourceLine" id="cb3-25" title="25">  v23 &lt;-<span class="st"> </span>p3<span class="op">-</span>p2</a>
<a class="sourceLine" id="cb3-26" title="26">  plane &lt;-<span class="st"> </span><span class="kw">plane3pts</span>(p1, p2, p3)</a>
<a class="sourceLine" id="cb3-27" title="27">  A &lt;-<span class="st"> </span><span class="kw">rbind</span>(plane[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], v12, v23)</a>
<a class="sourceLine" id="cb3-28" title="28">  b &lt;-<span class="st"> </span><span class="kw">c</span>(plane[<span class="dv">4</span>], <span class="kw">sum</span>(p12<span class="op">*</span>v12), <span class="kw">sum</span>(p23<span class="op">*</span>v23))</a>
<a class="sourceLine" id="cb3-29" title="29">  center &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">solve</span>(A) <span class="op">%*%</span><span class="st"> </span>b)</a>
<a class="sourceLine" id="cb3-30" title="30">  r &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(p1<span class="op">-</span>center)))</a>
<a class="sourceLine" id="cb3-31" title="31">  i &lt;-<span class="st"> </span>(p1<span class="op">-</span>center) <span class="op">/</span><span class="st"> </span>r</a>
<a class="sourceLine" id="cb3-32" title="32">  normal &lt;-<span class="st"> </span>plane[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(plane[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])))</a>
<a class="sourceLine" id="cb3-33" title="33">  <span class="kw">list</span>(<span class="dt">center =</span> center, <span class="dt">radius =</span> r, <span class="dt">i =</span> i, <span class="dt">j =</span> <span class="kw">cross</span>(i,normal))</a>
<a class="sourceLine" id="cb3-34" title="34">} <span class="co"># circle parameterization: center + radius*(cos(t)*i + sin(t)*j)</span></a>
<a class="sourceLine" id="cb3-35" title="35"></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co"># circle on unit sphere passing by three points </span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co"># given in spherical coordinates </span></a>
<a class="sourceLine" id="cb3-38" title="38">circleOnUnitSphere &lt;-<span class="st"> </span><span class="cf">function</span>(thph1, thph2, thph3){</a>
<a class="sourceLine" id="cb3-39" title="39">  theta1 &lt;-<span class="st"> </span>thph1[<span class="dv">1</span>]; phi1 &lt;-<span class="st"> </span>thph1[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb3-40" title="40">  theta2 &lt;-<span class="st"> </span>thph2[<span class="dv">1</span>]; phi2 &lt;-<span class="st"> </span>thph2[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb3-41" title="41">  theta3 &lt;-<span class="st"> </span>thph3[<span class="dv">1</span>]; phi3 &lt;-<span class="st"> </span>thph3[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb3-42" title="42">  p1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sin</span>(theta1)<span class="op">*</span><span class="kw">cos</span>(phi1), <span class="kw">sin</span>(theta1)<span class="op">*</span><span class="kw">sin</span>(phi1), <span class="kw">cos</span>(theta1))</a>
<a class="sourceLine" id="cb3-43" title="43">  p2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sin</span>(theta2)<span class="op">*</span><span class="kw">cos</span>(phi2), <span class="kw">sin</span>(theta2)<span class="op">*</span><span class="kw">sin</span>(phi2), <span class="kw">cos</span>(theta2))</a>
<a class="sourceLine" id="cb3-44" title="44">  p3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sin</span>(theta3)<span class="op">*</span><span class="kw">cos</span>(phi3), <span class="kw">sin</span>(theta3)<span class="op">*</span><span class="kw">sin</span>(phi3), <span class="kw">cos</span>(theta3))</a>
<a class="sourceLine" id="cb3-45" title="45">  <span class="kw">circle3pts</span>(p1, p2, p3)</a>
<a class="sourceLine" id="cb3-46" title="46">}</a></code></pre></div>
<p>The function returns a list with four elements: a point <code>center</code>, a number <code>radius</code>, and two vectors <code>i</code> and <code>j</code>. The parameterization of the spherical circle is then <code>center + radius*(cos(t)*i + sin(t)*j)</code> for <code>t</code> <span class="math inline">\(\in (0, 2\pi[\)</span>.</p>
<p>Let’s try. We enter three pairs of spherical coordinates and we apply the <code>circleOnUnitSphere</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">thph1 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.3</span>, <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">thph2 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.9</span>, <span class="fl">2.8</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">thph3 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">circ &lt;-<span class="st"> </span><span class="kw">circleOnUnitSphere</span>(thph1, thph2, thph3)</a></code></pre></div>
<p>Then we define the parametrization of the stereographically projected Hopf torus:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">F &lt;-<span class="st"> </span><span class="cf">function</span>(t, phi){</a>
<a class="sourceLine" id="cb5-2" title="2">  p &lt;-<span class="st"> </span><span class="kw">with</span>(circ, center <span class="op">+</span><span class="st"> </span>radius<span class="op">*</span>(<span class="kw">cos</span>(t)<span class="op">*</span>i <span class="op">+</span><span class="st"> </span><span class="kw">sin</span>(t)<span class="op">*</span>j))</a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="kw">Stereo</span>(<span class="kw">HopfInverse</span>(p, phi))</a>
<a class="sourceLine" id="cb5-4" title="4">}</a></code></pre></div>
<p>And we plot:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">parametric3d</span>(fx, fy, fz, <span class="dt">umin =</span> <span class="dv">0</span>, <span class="dt">umax =</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin =</span> <span class="dv">0</span>, <span class="dt">vmax =</span> <span class="dv">2</span><span class="op">*</span>pi, </a>
<a class="sourceLine" id="cb6-2" title="2">             <span class="dt">n =</span> <span class="dv">250</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;#363940&quot;</span>)</a>
<a class="sourceLine" id="cb6-3" title="3">rgl<span class="op">::</span><span class="kw">view3d</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dt">zoom =</span> <span class="fl">0.65</span>)</a></code></pre></div>
<p><img src="./figures/cyclide_grey.png" /></p>
<p>By rotating our spherical circle about the <span class="math inline">\(z\)</span>-axis, we can obtain the <a href="./linkedCyclidesParametric.html">linked cyclides</a>. Below is a R function to perform a rotation in spherical coordinates. See <a href="http://stla.github.io/stlapblog/posts/RotationSphericalCoordinates.html">this post</a> on my former blog for some explanations.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># helper functions: basic rotations ####</span></a>
<a class="sourceLine" id="cb7-2" title="2">Rx &lt;-<span class="st"> </span><span class="cf">function</span>(alpha){</a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>), <span class="op">-</span>1i<span class="op">*</span><span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb7-4" title="4">        <span class="kw">c</span>(<span class="op">-</span>1i<span class="op">*</span><span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>), <span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb7-5" title="5">}</a>
<a class="sourceLine" id="cb7-6" title="6">Ry &lt;-<span class="st"> </span><span class="cf">function</span>(alpha){</a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>), <span class="op">-</span><span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb7-8" title="8">        <span class="kw">c</span>(<span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>), <span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb7-9" title="9">}</a>
<a class="sourceLine" id="cb7-10" title="10">Rz &lt;-<span class="st"> </span><span class="cf">function</span>(alpha){</a>
<a class="sourceLine" id="cb7-11" title="11">  <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="kw">exp</span>(<span class="op">-</span>1i<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>), <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb7-12" title="12">        <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">exp</span>(1i<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb7-13" title="13">}</a>
<a class="sourceLine" id="cb7-14" title="14"></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co"># 3D rotation in spherical coordinates ####</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#' @description Rotation of a vector given in spherical coordinates.</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#' @param theta_phi spherical coordinates, a vector containing the </span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#' colatitude (or polar angle), between 0 and pi, and the longitude </span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#' (or azimuthal angle), between 0 and 2pi</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#' @param axis either a letter 'x', 'y' or 'z', a numeric vector of </span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#' length 2 (the spherical coordinates of the axis), or a numeric </span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#' vector of length 3 (the Cartesian coordinates of the axis)</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#' @param alpha angle of rotation</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#' @return The spherical coordinates of the transformed vector.</span></a>
<a class="sourceLine" id="cb7-25" title="25">rotation &lt;-<span class="st"> </span><span class="cf">function</span>(theta_phi, <span class="dt">axis=</span><span class="st">&quot;x&quot;</span>, alpha){</a>
<a class="sourceLine" id="cb7-26" title="26">  <span class="cf">if</span>(<span class="kw">is.character</span>(axis)){</a>
<a class="sourceLine" id="cb7-27" title="27">    axis &lt;-<span class="st"> </span><span class="kw">match.arg</span>(axis, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>))</a>
<a class="sourceLine" id="cb7-28" title="28">    R &lt;-<span class="st"> </span><span class="cf">switch</span>(axis, </a>
<a class="sourceLine" id="cb7-29" title="29">                <span class="st">&quot;x&quot;</span> =<span class="st"> </span><span class="kw">Rx</span>(alpha),</a>
<a class="sourceLine" id="cb7-30" title="30">                <span class="st">&quot;y&quot;</span> =<span class="st"> </span><span class="kw">Ry</span>(alpha),</a>
<a class="sourceLine" id="cb7-31" title="31">                <span class="st">&quot;z&quot;</span> =<span class="st"> </span><span class="kw">Rz</span>(alpha))</a>
<a class="sourceLine" id="cb7-32" title="32">  }<span class="cf">else</span> <span class="cf">if</span>(<span class="kw">length</span>(axis) <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb7-33" title="33">    Theta &lt;-<span class="st"> </span>axis[<span class="dv">1</span>]; Phi &lt;-<span class="st"> </span>axis[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb7-34" title="34">    R &lt;-<span class="st"> </span><span class="kw">Rz</span>(Phi) <span class="op">%*%</span><span class="st"> </span><span class="kw">Ry</span>(Theta) <span class="op">%*%</span><span class="st"> </span><span class="kw">Rz</span>(alpha) <span class="op">%*%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="st">           </span><span class="kw">t</span>(<span class="kw">Ry</span>(Theta)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">Conj</span>(<span class="kw">Rz</span>(Phi)))</a>
<a class="sourceLine" id="cb7-36" title="36">  }<span class="cf">else</span> <span class="cf">if</span>(<span class="kw">length</span>(axis) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>){</a>
<a class="sourceLine" id="cb7-37" title="37">    axis &lt;-<span class="st"> </span>axis <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(axis)))</a>
<a class="sourceLine" id="cb7-38" title="38">    X &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb7-39" title="39">    Y &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span>1i), <span class="kw">c</span>(1i,<span class="dv">0</span>)) </a>
<a class="sourceLine" id="cb7-40" title="40">    Z &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-41" title="41">    R &lt;-<span class="st"> </span><span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">diag</span>(<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>1i<span class="op">*</span><span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="st">           </span>(axis[<span class="dv">1</span>]<span class="op">*</span>X <span class="op">+</span><span class="st"> </span>axis[<span class="dv">2</span>]<span class="op">*</span>Y <span class="op">+</span><span class="st"> </span>axis[<span class="dv">3</span>]<span class="op">*</span>Z)</a>
<a class="sourceLine" id="cb7-43" title="43">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-44" title="44">    <span class="kw">stop</span>(<span class="st">&quot;`axis` must be either:</span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="st">         - a letter ('x', 'y' or 'z')</span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="st">         - a numeric vector of length two (spherical coordinates)</span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="st">         - a numeric vector of length three (Cartesian coordinates)&quot;</span>)</a>
<a class="sourceLine" id="cb7-48" title="48">  }</a>
<a class="sourceLine" id="cb7-49" title="49">  theta &lt;-<span class="st"> </span>theta_phi[<span class="dv">1</span>]; phi &lt;-<span class="st"> </span>theta_phi[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb7-50" title="50">  qubit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(theta<span class="op">/</span><span class="dv">2</span>), <span class="kw">exp</span>(1i<span class="op">*</span>phi)<span class="op">*</span><span class="kw">sin</span>(theta<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb7-51" title="51">  newqubit &lt;-<span class="st"> </span>R <span class="op">%*%</span><span class="st"> </span>qubit</a>
<a class="sourceLine" id="cb7-52" title="52">  z0 &lt;-<span class="st"> </span>newqubit[<span class="dv">1</span>,<span class="dv">1</span>]; z1 &lt;-<span class="st"> </span>newqubit[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-53" title="53">  <span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">atan</span>(<span class="kw">Mod</span>(z1)<span class="op">/</span><span class="kw">Mod</span>(z0)), <span class="kw">Arg</span>(z1)<span class="op">-</span><span class="kw">Arg</span>(z0))</a>
<a class="sourceLine" id="cb7-54" title="54">}</a></code></pre></div>
<p>Now, let’s rotate our spherical circle and plot:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">thph1 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph1, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">thph2 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph2, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">thph3 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph3, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-4" title="4">circ &lt;-<span class="st"> </span><span class="kw">circleOnUnitSphere</span>(thph1, thph2, thph3)</a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw">parametric3d</span>(fx, fy, fz, <span class="dt">umin =</span> <span class="dv">0</span>, <span class="dt">umax =</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin =</span> <span class="dv">0</span>, <span class="dt">vmax =</span> <span class="dv">2</span><span class="op">*</span>pi, </a>
<a class="sourceLine" id="cb8-6" title="6">             <span class="dt">n =</span> <span class="dv">250</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;#363940&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-7" title="7">thph1 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph1, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-8" title="8">thph2 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph2, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-9" title="9">thph3 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph3, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-10" title="10">circ &lt;-<span class="st"> </span><span class="kw">circleOnUnitSphere</span>(thph1, thph2, thph3)</a>
<a class="sourceLine" id="cb8-11" title="11"><span class="kw">parametric3d</span>(fx, fy, fz, <span class="dt">umin =</span> <span class="dv">0</span>, <span class="dt">umax =</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin =</span> <span class="dv">0</span>, <span class="dt">vmax =</span> <span class="dv">2</span><span class="op">*</span>pi, </a>
<a class="sourceLine" id="cb8-12" title="12">             <span class="dt">n =</span> <span class="dv">250</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;#363940&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="./figures/linkedCyclides_grey.png" /></p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">« Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->

  <!-- Google Prettify -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script> -->
  <script src="../libraries/highlighters/prettify/js/lang-r.js"></script>
  <script>
    var pres = document.getElementsByTagName("pre");
    for (var i = 0; i < pres.length; ++i) {
      
        pres[i].className = pres[i].className + " prettyprint linenums";
      
    }
    prettyPrint();
  </script> 


</html>