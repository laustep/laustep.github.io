<html>

<head>
  <title>Cantellated tesseract</title>
  <style>
    canvas {
      width: 100%;
      height: 100%
    }
  </style>
</head>

<body>
  <script src="../libraries/three.min.js"></script>
  <script src="../libraries/jquery.min.js"></script>
  <script src="../libraries/dat.gui.min.js"></script>

  <script> // vertices, edges and ridges ---------------------------------------
    // vertices ----------------------------------------------------------------
    var r = 1;
    var vertices = [[ -0.2705980500730985
                    , -0.2705980500730985
                    , -0.6532814824381883
                    , -0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , -0.2705980500730985
                    , -0.6532814824381883
                    , 0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , -0.2705980500730985
                    , 0.6532814824381883
                    , -0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , -0.2705980500730985
                    , 0.6532814824381883
                    , 0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , 0.2705980500730985
                    , -0.6532814824381883
                    , -0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , 0.2705980500730985
                    , -0.6532814824381883
                    , 0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , 0.2705980500730985
                    , 0.6532814824381883
                    , -0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , 0.2705980500730985
                    , 0.6532814824381883
                    , 0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , -0.2705980500730985
                    , -0.6532814824381883
                    , -0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , -0.2705980500730985
                    , -0.6532814824381883
                    , 0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , -0.2705980500730985
                    , 0.6532814824381883
                    , -0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , -0.2705980500730985
                    , 0.6532814824381883
                    , 0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , 0.2705980500730985
                    , -0.6532814824381883
                    , -0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , 0.2705980500730985
                    , -0.6532814824381883
                    , 0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , 0.2705980500730985
                    , 0.6532814824381883
                    , -0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , 0.2705980500730985
                    , 0.6532814824381883
                    , 0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , -0.2705980500730985
                    , -0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , -0.2705980500730985
                    , -0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , -0.2705980500730985
                    , 0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , -0.2705980500730985
                    , 0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , 0.2705980500730985
                    , -0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , 0.2705980500730985
                    , -0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , 0.2705980500730985
                    , 0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , 0.2705980500730985
                    , 0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ 0.6532814824381883
                    , -0.2705980500730985
                    , -0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ 0.6532814824381883
                    , -0.2705980500730985
                    , -0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ 0.6532814824381883
                    , -0.2705980500730985
                    , 0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ 0.6532814824381883
                    , -0.2705980500730985
                    , 0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ 0.6532814824381883
                    , 0.2705980500730985
                    , -0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ 0.6532814824381883
                    , 0.2705980500730985
                    , -0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ 0.6532814824381883
                    , 0.2705980500730985
                    , 0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ 0.6532814824381883
                    , 0.2705980500730985
                    , 0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ -0.6532814824381883
                    , -0.6532814824381883
                    , -0.2705980500730985
                    , -0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , -0.6532814824381883
                    , -0.2705980500730985
                    , 0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , -0.6532814824381883
                    , 0.2705980500730985
                    , -0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , -0.6532814824381883
                    , 0.2705980500730985
                    , 0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , 0.6532814824381883
                    , -0.2705980500730985
                    , -0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , 0.6532814824381883
                    , -0.2705980500730985
                    , 0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , 0.6532814824381883
                    , 0.2705980500730985
                    , -0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , 0.6532814824381883
                    , 0.2705980500730985
                    , 0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , -0.6532814824381883
                    , -0.2705980500730985
                    , -0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , -0.6532814824381883
                    , -0.2705980500730985
                    , 0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , -0.6532814824381883
                    , 0.2705980500730985
                    , -0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , -0.6532814824381883
                    , 0.2705980500730985
                    , 0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , 0.6532814824381883
                    , -0.2705980500730985
                    , -0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , 0.6532814824381883
                    , -0.2705980500730985
                    , 0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , 0.6532814824381883
                    , 0.2705980500730985
                    , -0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , 0.6532814824381883
                    , 0.2705980500730985
                    , 0.2705980500730985
                    ]
                  , [ -0.2705980500730985
                    , -0.6532814824381883
                    , -0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , -0.6532814824381883
                    , -0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , -0.6532814824381883
                    , 0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , -0.6532814824381883
                    , 0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , 0.6532814824381883
                    , -0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , 0.6532814824381883
                    , -0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , 0.6532814824381883
                    , 0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , 0.6532814824381883
                    , 0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , -0.6532814824381883
                    , -0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , -0.6532814824381883
                    , -0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , -0.6532814824381883
                    , 0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , -0.6532814824381883
                    , 0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , 0.6532814824381883
                    , -0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , 0.6532814824381883
                    , -0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , 0.6532814824381883
                    , 0.2705980500730985
                    , -0.6532814824381883
                    ]
                  , [ 0.2705980500730985
                    , 0.6532814824381883
                    , 0.2705980500730985
                    , 0.6532814824381883
                    ]
                  , [ -0.2705980500730985
                    , -0.6532814824381883
                    , -0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ -0.2705980500730985
                    , -0.6532814824381883
                    , -0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ -0.2705980500730985
                    , -0.6532814824381883
                    , 0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ -0.2705980500730985
                    , -0.6532814824381883
                    , 0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ -0.2705980500730985
                    , 0.6532814824381883
                    , -0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ -0.2705980500730985
                    , 0.6532814824381883
                    , -0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ -0.2705980500730985
                    , 0.6532814824381883
                    , 0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ -0.2705980500730985
                    , 0.6532814824381883
                    , 0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ 0.2705980500730985
                    , -0.6532814824381883
                    , -0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ 0.2705980500730985
                    , -0.6532814824381883
                    , -0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ 0.2705980500730985
                    , -0.6532814824381883
                    , 0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ 0.2705980500730985
                    , -0.6532814824381883
                    , 0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ 0.2705980500730985
                    , 0.6532814824381883
                    , -0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ 0.2705980500730985
                    , 0.6532814824381883
                    , -0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ 0.2705980500730985
                    , 0.6532814824381883
                    , 0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ 0.2705980500730985
                    , 0.6532814824381883
                    , 0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , -0.2705980500730985
                    , -0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , -0.2705980500730985
                    , -0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , -0.2705980500730985
                    , 0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , -0.2705980500730985
                    , 0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , 0.2705980500730985
                    , -0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , 0.2705980500730985
                    , -0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , 0.2705980500730985
                    , 0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ -0.6532814824381883
                    , 0.2705980500730985
                    , 0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , -0.2705980500730985
                    , -0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , -0.2705980500730985
                    , -0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , -0.2705980500730985
                    , 0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , -0.2705980500730985
                    , 0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , 0.2705980500730985
                    , -0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , 0.2705980500730985
                    , -0.6532814824381883
                    , 0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , 0.2705980500730985
                    , 0.6532814824381883
                    , -0.2705980500730985
                    ]
                  , [ 0.6532814824381883
                    , 0.2705980500730985
                    , 0.6532814824381883
                    , 0.2705980500730985
                    ]
                  ];
    // edges -------------------------------------------------------------------
    var edges = [ [ 0 , 4 ]
                , [ 0 , 8 ]
                , [ 0 , 16 ]
                , [ 0 , 48 ]
                , [ 0 , 64 ]
                , [ 0 , 80 ]
                , [ 1 , 5 ]
                , [ 1 , 9 ]
                , [ 1 , 17 ]
                , [ 1 , 49 ]
                , [ 1 , 65 ]
                , [ 1 , 81 ]
                , [ 2 , 6 ]
                , [ 2 , 10 ]
                , [ 2 , 18 ]
                , [ 2 , 50 ]
                , [ 2 , 66 ]
                , [ 2 , 82 ]
                , [ 3 , 7 ]
                , [ 3 , 11 ]
                , [ 3 , 19 ]
                , [ 3 , 51 ]
                , [ 3 , 67 ]
                , [ 3 , 83 ]
                , [ 4 , 12 ]
                , [ 4 , 20 ]
                , [ 4 , 52 ]
                , [ 4 , 68 ]
                , [ 4 , 84 ]
                , [ 5 , 13 ]
                , [ 5 , 21 ]
                , [ 5 , 53 ]
                , [ 5 , 69 ]
                , [ 5 , 85 ]
                , [ 6 , 14 ]
                , [ 6 , 22 ]
                , [ 6 , 54 ]
                , [ 6 , 70 ]
                , [ 6 , 86 ]
                , [ 7 , 15 ]
                , [ 7 , 23 ]
                , [ 7 , 55 ]
                , [ 7 , 71 ]
                , [ 7 , 87 ]
                , [ 8 , 12 ]
                , [ 8 , 24 ]
                , [ 8 , 56 ]
                , [ 8 , 72 ]
                , [ 8 , 88 ]
                , [ 9 , 13 ]
                , [ 9 , 25 ]
                , [ 9 , 57 ]
                , [ 9 , 73 ]
                , [ 9 , 89 ]
                , [ 10 , 14 ]
                , [ 10 , 26 ]
                , [ 10 , 58 ]
                , [ 10 , 74 ]
                , [ 10 , 90 ]
                , [ 11 , 15 ]
                , [ 11 , 27 ]
                , [ 11 , 59 ]
                , [ 11 , 75 ]
                , [ 11 , 91 ]
                , [ 12 , 28 ]
                , [ 12 , 60 ]
                , [ 12 , 76 ]
                , [ 12 , 92 ]
                , [ 13 , 29 ]
                , [ 13 , 61 ]
                , [ 13 , 77 ]
                , [ 13 , 93 ]
                , [ 14 , 30 ]
                , [ 14 , 62 ]
                , [ 14 , 78 ]
                , [ 14 , 94 ]
                , [ 15 , 31 ]
                , [ 15 , 63 ]
                , [ 15 , 79 ]
                , [ 15 , 95 ]
                , [ 16 , 18 ]
                , [ 16 , 20 ]
                , [ 16 , 32 ]
                , [ 16 , 48 ]
                , [ 16 , 80 ]
                , [ 17 , 19 ]
                , [ 17 , 21 ]
                , [ 17 , 33 ]
                , [ 17 , 49 ]
                , [ 17 , 81 ]
                , [ 18 , 22 ]
                , [ 18 , 34 ]
                , [ 18 , 50 ]
                , [ 18 , 82 ]
                , [ 19 , 23 ]
                , [ 19 , 35 ]
                , [ 19 , 51 ]
                , [ 19 , 83 ]
                , [ 20 , 22 ]
                , [ 20 , 36 ]
                , [ 20 , 52 ]
                , [ 20 , 84 ]
                , [ 21 , 23 ]
                , [ 21 , 37 ]
                , [ 21 , 53 ]
                , [ 21 , 85 ]
                , [ 22 , 38 ]
                , [ 22 , 54 ]
                , [ 22 , 86 ]
                , [ 23 , 39 ]
                , [ 23 , 55 ]
                , [ 23 , 87 ]
                , [ 24 , 26 ]
                , [ 24 , 28 ]
                , [ 24 , 40 ]
                , [ 24 , 56 ]
                , [ 24 , 88 ]
                , [ 25 , 27 ]
                , [ 25 , 29 ]
                , [ 25 , 41 ]
                , [ 25 , 57 ]
                , [ 25 , 89 ]
                , [ 26 , 30 ]
                , [ 26 , 42 ]
                , [ 26 , 58 ]
                , [ 26 , 90 ]
                , [ 27 , 31 ]
                , [ 27 , 43 ]
                , [ 27 , 59 ]
                , [ 27 , 91 ]
                , [ 28 , 30 ]
                , [ 28 , 44 ]
                , [ 28 , 60 ]
                , [ 28 , 92 ]
                , [ 29 , 31 ]
                , [ 29 , 45 ]
                , [ 29 , 61 ]
                , [ 29 , 93 ]
                , [ 30 , 46 ]
                , [ 30 , 62 ]
                , [ 30 , 94 ]
                , [ 31 , 47 ]
                , [ 31 , 63 ]
                , [ 31 , 95 ]
                , [ 32 , 33 ]
                , [ 32 , 34 ]
                , [ 32 , 48 ]
                , [ 32 , 64 ]
                , [ 32 , 80 ]
                , [ 33 , 35 ]
                , [ 33 , 49 ]
                , [ 33 , 65 ]
                , [ 33 , 81 ]
                , [ 34 , 35 ]
                , [ 34 , 50 ]
                , [ 34 , 66 ]
                , [ 34 , 82 ]
                , [ 35 , 51 ]
                , [ 35 , 67 ]
                , [ 35 , 83 ]
                , [ 36 , 37 ]
                , [ 36 , 38 ]
                , [ 36 , 52 ]
                , [ 36 , 68 ]
                , [ 36 , 84 ]
                , [ 37 , 39 ]
                , [ 37 , 53 ]
                , [ 37 , 69 ]
                , [ 37 , 85 ]
                , [ 38 , 39 ]
                , [ 38 , 54 ]
                , [ 38 , 70 ]
                , [ 38 , 86 ]
                , [ 39 , 55 ]
                , [ 39 , 71 ]
                , [ 39 , 87 ]
                , [ 40 , 41 ]
                , [ 40 , 42 ]
                , [ 40 , 56 ]
                , [ 40 , 72 ]
                , [ 40 , 88 ]
                , [ 41 , 43 ]
                , [ 41 , 57 ]
                , [ 41 , 73 ]
                , [ 41 , 89 ]
                , [ 42 , 43 ]
                , [ 42 , 58 ]
                , [ 42 , 74 ]
                , [ 42 , 90 ]
                , [ 43 , 59 ]
                , [ 43 , 75 ]
                , [ 43 , 91 ]
                , [ 44 , 45 ]
                , [ 44 , 46 ]
                , [ 44 , 60 ]
                , [ 44 , 76 ]
                , [ 44 , 92 ]
                , [ 45 , 47 ]
                , [ 45 , 61 ]
                , [ 45 , 77 ]
                , [ 45 , 93 ]
                , [ 46 , 47 ]
                , [ 46 , 62 ]
                , [ 46 , 78 ]
                , [ 46 , 94 ]
                , [ 47 , 63 ]
                , [ 47 , 79 ]
                , [ 47 , 95 ]
                , [ 48 , 50 ]
                , [ 48 , 56 ]
                , [ 48 , 64 ]
                , [ 49 , 51 ]
                , [ 49 , 57 ]
                , [ 49 , 65 ]
                , [ 50 , 58 ]
                , [ 50 , 66 ]
                , [ 51 , 59 ]
                , [ 51 , 67 ]
                , [ 52 , 54 ]
                , [ 52 , 60 ]
                , [ 52 , 68 ]
                , [ 53 , 55 ]
                , [ 53 , 61 ]
                , [ 53 , 69 ]
                , [ 54 , 62 ]
                , [ 54 , 70 ]
                , [ 55 , 63 ]
                , [ 55 , 71 ]
                , [ 56 , 58 ]
                , [ 56 , 72 ]
                , [ 57 , 59 ]
                , [ 57 , 73 ]
                , [ 58 , 74 ]
                , [ 59 , 75 ]
                , [ 60 , 62 ]
                , [ 60 , 76 ]
                , [ 61 , 63 ]
                , [ 61 , 77 ]
                , [ 62 , 78 ]
                , [ 63 , 79 ]
                , [ 64 , 65 ]
                , [ 64 , 72 ]
                , [ 64 , 80 ]
                , [ 65 , 73 ]
                , [ 65 , 81 ]
                , [ 66 , 67 ]
                , [ 66 , 74 ]
                , [ 66 , 82 ]
                , [ 67 , 75 ]
                , [ 67 , 83 ]
                , [ 68 , 69 ]
                , [ 68 , 76 ]
                , [ 68 , 84 ]
                , [ 69 , 77 ]
                , [ 69 , 85 ]
                , [ 70 , 71 ]
                , [ 70 , 78 ]
                , [ 70 , 86 ]
                , [ 71 , 79 ]
                , [ 71 , 87 ]
                , [ 72 , 73 ]
                , [ 72 , 88 ]
                , [ 73 , 89 ]
                , [ 74 , 75 ]
                , [ 74 , 90 ]
                , [ 75 , 91 ]
                , [ 76 , 77 ]
                , [ 76 , 92 ]
                , [ 77 , 93 ]
                , [ 78 , 79 ]
                , [ 78 , 94 ]
                , [ 79 , 95 ]
                , [ 80 , 81 ]
                , [ 80 , 84 ]
                , [ 81 , 85 ]
                , [ 82 , 83 ]
                , [ 82 , 86 ]
                , [ 83 , 87 ]
                , [ 84 , 85 ]
                , [ 86 , 87 ]
                , [ 88 , 89 ]
                , [ 88 , 92 ]
                , [ 89 , 93 ]
                , [ 90 , 91 ]
                , [ 90 , 94 ]
                , [ 91 , 95 ]
                , [ 92 , 93 ]
                , [ 94 , 95 ]
                ];
    // tetrahedra --------------------------------------------------------------
    var ridges = [  [ 11 , 15 , 31 , 27 ]
                  , [ 11 , 15 , 95 , 91 ]
                  , [ 27 , 31 , 95 , 91 ]
                  , [ 11 , 27 , 91 ]
                  , [ 15 , 31 , 95 ]
                  , [ 15 , 31 , 63 ]
                  , [ 31 , 47 , 63 ]
                  , [ 31 , 47 , 95 ]
                  , [ 15 , 79 , 95 ]
                  , [ 47 , 79 , 95 ]
                  , [ 47 , 63 , 79 ]
                  , [ 15 , 63 , 79 ]
                  , [ 13 , 29 , 93 ]
                  , [ 9 , 13 , 29 , 25 ]
                  , [ 9 , 13 , 93 , 89 ]
                  , [ 25 , 29 , 93 , 89 ]
                  , [ 9 , 25 , 89 ]
                  , [ 29 , 31 , 47 , 45 ]
                  , [ 45 , 47 , 63 , 61 ]
                  , [ 29 , 31 , 63 , 61 ]
                  , [ 29 , 45 , 61 ]
                  , [ 2 , 6 , 22 , 18 ]
                  , [ 2 , 18 , 82 ]
                  , [ 18 , 22 , 86 , 82 ]
                  , [ 2 , 6 , 86 , 82 ]
                  , [ 6 , 22 , 86 ]
                  , [ 78 , 79 , 95 , 94 ]
                  , [ 46 , 47 , 79 , 78 ]
                  , [ 46 , 47 , 95 , 94 ]
                  , [ 46 , 78 , 94 ]
                  , [ 20 , 22 , 54 , 52 ]
                  , [ 20 , 22 , 38 , 36 ]
                  , [ 20 , 36 , 52 ]
                  , [ 36 , 38 , 54 , 52 ]
                  , [ 22 , 38 , 54 ]
                  , [ 6 , 54 , 70 ]
                  , [ 6 , 22 , 54 ]
                  , [ 6 , 70 , 86 ]
                  , [ 22 , 38 , 86 ]
                  , [ 38 , 70 , 86 ]
                  , [ 38 , 54 , 70 ]
                  , [ 24 , 28 , 92 , 88 ]
                  , [ 8 , 12 , 28 , 24 ]
                  , [ 12 , 28 , 92 ]
                  , [ 8 , 12 , 92 , 88 ]
                  , [ 8 , 24 , 88 ]
                  , [ 48 , 56 , 72 , 64 ]
                  , [ 0 , 8 , 56 , 48 ]
                  , [ 8 , 56 , 72 ]
                  , [ 0 , 8 , 72 , 64 ]
                  , [ 0 , 48 , 64 ]
                  , [ 6 , 14 , 78 , 70 ]
                  , [ 54 , 62 , 78 , 70 ]
                  , [ 6 , 14 , 62 , 54 ]
                  , [ 14 , 62 , 78 ]
                  , [ 14 , 78 , 94 ]
                  , [ 46 , 62 , 78 ]
                  , [ 14 , 30 , 62 ]
                  , [ 30 , 46 , 62 ]
                  , [ 30 , 46 , 94 ]
                  , [ 14 , 30 , 94 ]
                  , [ 44 , 46 , 62 , 60 ]
                  , [ 28 , 30 , 46 , 44 ]
                  , [ 28 , 44 , 60 ]
                  , [ 28 , 30 , 62 , 60 ]
                  , [ 2 , 10 , 58 , 50 ]
                  , [ 2 , 10 , 74 , 66 ]
                  , [ 2 , 50 , 66 ]
                  , [ 50 , 58 , 74 , 66 ]
                  , [ 10 , 58 , 74 ]
                  , [ 2 , 66 , 82 ]
                  , [ 2 , 18 , 50 ]
                  , [ 18 , 34 , 82 ]
                  , [ 34 , 66 , 82 ]
                  , [ 18 , 34 , 50 ]
                  , [ 34 , 50 , 66 ]
                  , [ 16 , 18 , 34 , 32 ]
                  , [ 16 , 18 , 50 , 48 ]
                  , [ 32 , 34 , 50 , 48 ]
                  , [ 16 , 32 , 48 ]
                  , [ 66 , 67 , 83 , 82 ]
                  , [ 34 , 35 , 83 , 82 ]
                  , [ 35 , 67 , 83 ]
                  , [ 34 , 35 , 67 , 66 ]
                  , [ 12 , 28 , 60 ]
                  , [ 28 , 44 , 92 ]
                  , [ 44 , 76 , 92 ]
                  , [ 12 , 76 , 92 ]
                  , [ 44 , 60 , 76 ]
                  , [ 12 , 60 , 76 ]
                  , [ 0 , 16 , 48 ]
                  , [ 32 , 48 , 64 ]
                  , [ 0 , 64 , 80 ]
                  , [ 32 , 64 , 80 ]
                  , [ 16 , 32 , 80 ]
                  , [ 0 , 16 , 80 ]
                  , [ 10 , 14 , 30 , 26 ]
                  , [ 10 , 14 , 94 , 90 ]
                  , [ 26 , 30 , 94 , 90 ]
                  , [ 10 , 26 , 90 ]
                  , [ 3 , 19 , 83 ]
                  , [ 3 , 67 , 83 ]
                  , [ 19 , 35 , 83 ]
                  , [ 35 , 51 , 67 ]
                  , [ 19 , 35 , 51 ]
                  , [ 3 , 19 , 51 ]
                  , [ 3 , 51 , 67 ]
                  , [ 3 , 11 , 75 , 67 ]
                  , [ 51 , 59 , 75 , 67 ]
                  , [ 11 , 59 , 75 ]
                  , [ 3 , 11 , 59 , 51 ]
                  , [ 4 , 12 , 60 , 52 ]
                  , [ 52 , 60 , 76 , 68 ]
                  , [ 4 , 12 , 76 , 68 ]
                  , [ 4 , 52 , 68 ]
                  , [ 29 , 45 , 93 ]
                  , [ 13 , 29 , 61 ]
                  , [ 45 , 61 , 77 ]
                  , [ 13 , 61 , 77 ]
                  , [ 45 , 77 , 93 ]
                  , [ 13 , 77 , 93 ]
                  , [ 5 , 13 , 61 , 53 ]
                  , [ 53 , 61 , 77 , 69 ]
                  , [ 5 , 13 , 77 , 69 ]
                  , [ 5 , 53 , 69 ]
                  , [ 44 , 45 , 93 , 92 ]
                  , [ 44 , 45 , 77 , 76 ]
                  , [ 76 , 77 , 93 , 92 ]
                  , [ 21 , 37 , 53 ]
                  , [ 5 , 21 , 53 ]
                  , [ 37 , 53 , 69 ]
                  , [ 21 , 37 , 85 ]
                  , [ 5 , 21 , 85 ]
                  , [ 37 , 69 , 85 ]
                  , [ 5 , 69 , 85 ]
                  , [ 8 , 24 , 56 ]
                  , [ 8 , 72 , 88 ]
                  , [ 40 , 56 , 72 ]
                  , [ 24 , 40 , 56 ]
                  , [ 24 , 40 , 88 ]
                  , [ 40 , 72 , 88 ]
                  , [ 1 , 9 , 73 , 65 ]
                  , [ 49 , 57 , 73 , 65 ]
                  , [ 9 , 57 , 73 ]
                  , [ 1 , 9 , 57 , 49 ]
                  , [ 1 , 49 , 65 ]
                  , [ 17 , 19 , 35 , 33 ]
                  , [ 17 , 19 , 51 , 49 ]
                  , [ 33 , 35 , 51 , 49 ]
                  , [ 17 , 33 , 49 ]
                  , [ 33 , 49 , 65 ]
                  , [ 1 , 17 , 49 ]
                  , [ 1 , 17 , 81 ]
                  , [ 17 , 33 , 81 ]
                  , [ 1 , 65 , 81 ]
                  , [ 33 , 65 , 81 ]
                  , [ 32 , 33 , 65 , 64 ]
                  , [ 32 , 33 , 81 , 80 ]
                  , [ 64 , 65 , 81 , 80 ]
                  , [ 1 , 5 , 21 , 17 ]
                  , [ 17 , 21 , 85 , 81 ]
                  , [ 1 , 5 , 85 , 81 ]
                  , [ 0 , 4 , 20 , 16 ]
                  , [ 16 , 20 , 84 , 80 ]
                  , [ 0 , 4 , 84 , 80 ]
                  , [ 4 , 20 , 84 ]
                  , [ 4 , 20 , 52 ]
                  , [ 36 , 52 , 68 ]
                  , [ 36 , 68 , 84 ]
                  , [ 4 , 68 , 84 ]
                  , [ 20 , 36 , 84 ]
                  , [ 68 , 69 , 85 , 84 ]
                  , [ 36 , 37 , 69 , 68 ]
                  , [ 36 , 37 , 85 , 84 ]
                  , [ 10 , 26 , 58 ]
                  , [ 10 , 74 , 90 ]
                  , [ 26 , 42 , 58 ]
                  , [ 26 , 42 , 90 ]
                  , [ 42 , 58 , 74 ]
                  , [ 42 , 74 , 90 ]
                  , [ 24 , 26 , 58 , 56 ]
                  , [ 24 , 26 , 42 , 40 ]
                  , [ 40 , 42 , 58 , 56 ]
                  , [ 9 , 73 , 89 ]
                  , [ 9 , 25 , 57 ]
                  , [ 25 , 41 , 89 ]
                  , [ 41 , 73 , 89 ]
                  , [ 25 , 41 , 57 ]
                  , [ 41 , 57 , 73 ]
                  , [ 72 , 73 , 89 , 88 ]
                  , [ 40 , 41 , 89 , 88 ]
                  , [ 40 , 41 , 73 , 72 ]
                  , [ 21 , 23 , 55 , 53 ]
                  , [ 37 , 39 , 55 , 53 ]
                  , [ 21 , 23 , 39 , 37 ]
                  , [ 23 , 39 , 55 ]
                  , [ 7 , 15 , 63 , 55 ]
                  , [ 55 , 63 , 79 , 71 ]
                  , [ 7 , 15 , 79 , 71 ]
                  , [ 7 , 55 , 71 ]
                  , [ 38 , 39 , 71 , 70 ]
                  , [ 38 , 39 , 87 , 86 ]
                  , [ 70 , 71 , 87 , 86 ]
                  , [ 39 , 71 , 87 ]
                  , [ 7 , 23 , 55 ]
                  , [ 39 , 55 , 71 ]
                  , [ 23 , 39 , 87 ]
                  , [ 7 , 71 , 87 ]
                  , [ 7 , 23 , 87 ]
                  , [ 3 , 7 , 23 , 19 ]
                  , [ 19 , 23 , 87 , 83 ]
                  , [ 3 , 7 , 87 , 83 ]
                  , [ 11 , 27 , 59 ]
                  , [ 11 , 75 , 91 ]
                  , [ 27 , 43 , 91 ]
                  , [ 43 , 75 , 91 ]
                  , [ 27 , 43 , 59 ]
                  , [ 43 , 59 , 75 ]
                  , [ 74 , 75 , 91 , 90 ]
                  , [ 42 , 43 , 75 , 74 ]
                  , [ 42 , 43 , 91 , 90 ]
                  , [ 25 , 27 , 59 , 57 ]
                  , [ 41 , 43 , 59 , 57 ]
                  , [ 25 , 27 , 43 , 41 ]
                ];
  </script>

  <script> // Cone mesh --------------------------------------------------------
    // basic cone mesh ---------------------------------------------------------
    function Cmesh0(h, R, r, nstacks, nslices, material) {
      if(r>R){
        throw new Error("Ooops !");
      }
      var ratio = r / R;
      var k = (ratio - 1) / h;
      // grid ------------------------------------------------------------------
      nstacks = nstacks + 1;
      var u_ = new Array(nstacks);
      for (var i = 0; i < nstacks; i++) {
        u_[i] = h * i / (nstacks - 1);
      }
      var v_ = new Array(nslices);
      for (var i = 0; i < nslices; i++) {
        v_[i] = 2 * Math.PI * i / nslices;
      }
      // vertices & normals ----------------------------------------------------
      var vertices = new Array(nstacks * nslices);
      var normals = new Array(nstacks * nslices);
      for (var i = 0; i < nstacks; i++) {
        var g = 1 + k * u_[i];
        for (var j = 0; j < nslices; j++) {
          var cosv = R * Math.cos(v_[j]);
          var sinv = R * Math.sin(v_[j]);
          var v = new THREE.Vector3(
            g * cosv,
            g * sinv,
            u_[i]
          );
          vertices[i * nslices + j] = v;
          var t1 = new THREE.Vector3(
            k * cosv,
            k * sinv,
            1
          );
          var t2 = new THREE.Vector3(
            -v.y, v.x, 0
          )
          normals[i * nslices + j] = t1.cross(t2).normalize().negate();
        }
      }
      // mesh ------------------------------------------------------------------
      var geom = new THREE.Geometry();
      for (var i = 0; i < (nstacks - 1); i++) {
        for (var j = 0; j < nslices; j++) {
          var jp1 = j == nslices - 1 ? 0 : j + 1;
          geom.vertices.push(vertices[i * nslices + j]);
          geom.vertices.push(vertices[i * nslices + jp1]);
          geom.vertices.push(vertices[(i + 1) * nslices + j]);
          geom.faces.push(new THREE.Face3(
            6 * (i * nslices + j),
            6 * (i * nslices + j) + 1,
            6 * (i * nslices + j) + 2,
            [
              normals[i * nslices + j],
              normals[i * nslices + jp1],
              normals[(i + 1) * nslices + j]
            ]
          ));
          geom.vertices.push(vertices[(i + 1) * nslices + j]);
          geom.vertices.push(vertices[i * nslices + jp1]);
          geom.vertices.push(vertices[(i + 1) * nslices + jp1]);
          geom.faces.push(new THREE.Face3(
            6 * (i * nslices + j) + 3,
            6 * (i * nslices + j) + 4,
            6 * (i * nslices + j) + 5,
            [
              normals[(i + 1) * nslices + j],
              normals[i * nslices + jp1],
              normals[(i + 1) * nslices + jp1]
            ]
          ));
        }
      }
      var bufGeom = new THREE.BufferGeometry().fromGeometry(geom);
      var conemesh = new THREE.Mesh(bufGeom, material);
      return conemesh;
    }
    // general cone mesh -------------------------------------------------------
    function ConeMesh(cr1, r1, cr2, r2, nstacks, nslices, material) {
      if (r2 > r1) {
        return ConeMesh(cr2, r2, cr1, r1, nstacks, nslices, material);
      }
      var w0 = cr2.clone().sub(cr1);
      var conemesh0 = Cmesh0(w0.length(), r1, r2, nstacks, nslices, material);
      var w = w0.normalize();
      var wx = w.x; var wy = w.y;
      var s = Math.sqrt(wx * wx + wy * wy);
      if (s == 0) {
        var coef = w.z > 0 ? 1 : -1;
        var m = new THREE.Matrix4().set(
          1, 0, 0, cr1.x,
          0, coef, 0, cr1.y,
          0, 0, coef, cr1.z,
          0, 0, 0, 1
        )
        conemesh0.matrix = m;
        conemesh0.matrixAutoUpdate = false;
        return conemesh0;
      }
      var u = new THREE.Vector3(wy / s, -wx / s, 0);
      var v = w.clone().cross(u);
      var m = new THREE.Matrix4().set(
        u.x, v.x, w.x, cr1.x,
        u.y, v.y, w.y, cr1.y,
        u.z, v.z, w.z, cr1.z,
        0, 0, 0, 1
      )
      conemesh0.matrix = m;
      conemesh0.matrixAutoUpdate = false;
      return conemesh0;
    }
  </script>

  <script> // 4D-related functions ---------------------------------------------
    // rotation in 4D space
    function rightIsoclinic(theta, phi, alpha, x) {
      var x0 = x[0], x1 = x[1], x2 = x[2], x3 = x[3];
      var q0 = Math.cos(alpha);
      var q1 = Math.sin(theta) * Math.cos(phi) * Math.sin(alpha);
      var q2 = Math.sin(theta) * Math.sin(phi) * Math.sin(alpha);
      var q3 = Math.cos(theta) * Math.sin(alpha);
      return [
        q0 * x0 - q1 * x1 - q2 * x2 - q3 * x3,
        q1 * x0 + q0 * x1 + q3 * x2 - q2 * x3,
        q2 * x0 - q3 * x1 + q0 * x2 + q1 * x3,
        q3 * x0 + q2 * x1 - q1 * x2 + q0 * x3
      ];
    }
    // stereographic projection
    function stereo(x, r) {
      return [x[0] / (r - x[3]), x[1] / (r - x[3]), x[2] / (r - x[3])];
    }
  </script>

  <script> // make the 180 objects ---------------------------------------------
    var Objects = new Array(180);
    var geoSphere = new THREE.SphereBufferGeometry(0.07, 16, 16);
    var whitesmoke = new THREE.MeshPhongMaterial({color: 0xf5f5f5});
    var orangeRed = new THREE.MeshBasicMaterial({
      color: 0xff4000,
      transparent: true,
      opacity: 0.5,
      side: THREE.DoubleSide
    });
    var gold = new THREE.MeshBasicMaterial({
      color: 0xf5d700,
      transparent: true,
      opacity: 0.5,
      side: THREE.DoubleSide
    });
    var materialArray = [orangeRed, gold];
    for (var i = 0; i < 180; i++) {
      // rotated vertices
      var points = vertices.map(function (vertex) {
        return stereo(rightIsoclinic(0, 0, 2 * i * Math.PI / 180, vertex), r)
      });
      //
      var object = new THREE.Object3D();
      // add vertices as spheres
      for (var j = 0; j < vertices.length; j++) {
        var sphere = new THREE.Mesh(geoSphere, whitesmoke);
        sphere.position.set(points[j][0], points[j][1], points[j][2]);
        object.add(sphere);
      }
      // edges
      for (var j = 0; j < edges.length; j++) {
        var pt1 = points[edges[j][0]];
        var pt2 = points[edges[j][1]];
        var cr1 = new THREE.Vector3().fromArray(pt1);
        var cr2 = new THREE.Vector3().fromArray(pt2);
        var conemesh = ConeMesh(cr1, 0.05, cr2, 0.05, 3, 30, whitesmoke);
        object.add(conemesh);
      }
      // ridges
      var geoRidge = new THREE.Geometry();
      var faceIndex = 0;
      for (var j = 0; j < ridges.length; j++) {
        var indices = ridges[j];
        if(indices.length == 3){
          geoRidge.vertices.push(
            new THREE.Vector3().fromArray(points[indices[0]]),
            new THREE.Vector3().fromArray(points[indices[1]]),
            new THREE.Vector3().fromArray(points[indices[2]])
          );
          geoRidge.faces.push(new THREE.Face3(
            faceIndex, faceIndex+1, faceIndex+2,
            null, null, 0
          ));
          faceIndex += 3;
        }else{
          geoRidge.vertices.push(
            new THREE.Vector3().fromArray(points[indices[0]]),
            new THREE.Vector3().fromArray(points[indices[2]]),
            new THREE.Vector3().fromArray(points[indices[1]])
          );
          geoRidge.faces.push(new THREE.Face3(
            faceIndex, faceIndex+1, faceIndex+2,
            null, null, 1
          ));
          geoRidge.vertices.push(
            new THREE.Vector3().fromArray(points[indices[0]]),
            new THREE.Vector3().fromArray(points[indices[3]]),
            new THREE.Vector3().fromArray(points[indices[2]])
          );
          geoRidge.faces.push(new THREE.Face3(
            faceIndex+3, faceIndex+4, faceIndex+5,
            null, null, 1
          ));
          faceIndex += 6;
        }
      }
      var ridgeMesh = new THREE.Mesh(geoRidge, materialArray);
      object.add(ridgeMesh);
      //
      Objects[i] = object;
    }
  </script>

  <script> // dat.gui controls -------------------------------------------------
    var z0 = 8;
    var dgcontrols = new function () {
      this.cameraz = z0;
      this.rotationSpeed = 25;
    }
    var gui = new dat.GUI({
      autoplace: false,
      width: 300
    });
    gui.add(dgcontrols, 'cameraz').min(5).max(15).step(0.5)
      .name("Camera position");
    gui.add(dgcontrols, 'rotationSpeed').min(1).max(100).step(3)
      .name("Speed of 4D rotation");
  </script>

  <script> // three.js scene ---------------------------------------------------
    var scene = new THREE.Scene();
    var aspect = window.innerWidth / window.innerHeight;
    var camera = new THREE.PerspectiveCamera(75, aspect, 1, 10000);
    camera.position.z = z0;
    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);
    var scene = new THREE.Scene();
    var ambientLight = new THREE.AmbientLight(0xcccccc, 0.4);
    scene.add(ambientLight);
    var pointLight = new THREE.PointLight(0xffffff, 0.8);
    camera.add(pointLight);
    scene.add(camera);
    // rendering function ------------------------------------------------------
    window.requestAnimFrame = (function () {
      return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        function (callback) {
          window.setTimeout(callback, 1000 / 60);
        };
    })();
    var k = 0;
    function render() {
      var object = Objects[k];
      scene.add(object);
      camera.position.z = dgcontrols.cameraz;
      renderer.render(scene, camera);
      scene.remove(object);
      k += 1;
      if (k == 180) {
        k = 0;
      }
      setTimeout(function () {
        requestAnimationFrame(render);
      }, 1000 / dgcontrols.rotationSpeed);
    }
  </script>

  <script> // dragging ---------------------------------------------------------
    var isDragging = false;
    var previousMousePosition = {
      x: 0,
      y: 0
    };
    $(renderer.domElement).on('mousedown', function (e) {
      isDragging = true;
    }).on('mousemove', function (e) {
      var deltaMove = {
        x: e.offsetX - previousMousePosition.x,
        y: e.offsetY - previousMousePosition.y
      };
      if (isDragging) {
        var deltaRotationQuaternion = new THREE.Quaternion()
          .setFromEuler(new THREE.Euler(
            Math.PI / 180 * (deltaMove.y * .5),
            Math.PI / 180 * (deltaMove.x * .5),
            0,
            'XYZ'
          ));
        for (var i = 0; i < 180; i++) {
          Objects[i].quaternion.multiplyQuaternions(deltaRotationQuaternion,
            Objects[i].quaternion);
        }
      }
      previousMousePosition = {
        x: e.offsetX,
        y: e.offsetY
      };
    });
    $(document).on('mouseup', function (e) {
      isDragging = false;
    });
  </script>

  <script> // rendering --------------------------------------------------------
    render();
  </script>

</body>

</html>
